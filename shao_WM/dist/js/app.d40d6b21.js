(function(){var e={6700:function(e,t,a){var s={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":941,"./en-il.js":941,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":3939,"./es-us.js":3939,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=r,e.exports=i,i.id=6700},1269:function(e,t,a){"use strict";var s=a(144),i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"background-color":"rgba(235, 235, 235, 0.08)"},attrs:{id:"app"}},[t("router-view")],1)},r=[],n={name:"app"},l=n,o=a(1001),c=(0,o.Z)(l,i,r,!1,null,null,null),d=c.exports,u=a(8345),m=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"building"}},[t("div",{staticStyle:{"margin-top":"140px",width:"auto","text-align":"center"}},[t("div",{staticStyle:{"margin-left":"450px"}},[t("el-tabs",{attrs:{"tab-position":"left"}},[t("el-tab-pane",{attrs:{label:"密码登录"}},[t("login_table")],1),t("el-tab-pane",{attrs:{label:"邮件登录"}},[t("email_login")],1)],1)],1)])])},h=[],p=function(){var e=this,t=e._self._c;return t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"login-container",staticStyle:{"margin-top":"20px","margin-left":"20px"},attrs:{"label-position":"left","label-width":"0px"}},[t("h3",{staticClass:"login_title"},[e._v("密码登录")]),t("el-form-item",{attrs:{prop:"account"}},[t("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"用户名"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{prop:"checkPass"}},[t("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-checkbox",{staticStyle:{color:"#a0a0a0",margin:"0 0 20px 0"},attrs:{name:"remember-me"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")]),t("Vcode",{attrs:{show:e.isShow},on:{success:e.success,close:e.close}}),t("el-form-item",{staticStyle:{width:"100%"}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[e._v("登录")])],1),t("router-link",{attrs:{to:"/re"}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"success"}},[e._v("注册")])],1)],1)},g=[],f=a(9669),v=a.n(f),b=a(4720),y=a.n(b);v().interceptors.response.use((e=>{if("over"!=e.data.status)return e;window.location.href="/#/?over=1"}),(e=>{})),v().defaults.baseURL="http://121.196.209.48:8081";let w="";v().defaults.withCredentials=!0,v().interceptors.request.use((e=>{if(!e.url.endsWith("/login")&&null!=localStorage.getItem("token")){const t="Bearer "+localStorage.getItem("token");e.headers.common["Authorization"]=t}return e}));const x=(e,t)=>v()({method:"post",url:`${w}${e}`,data:t,headers:{"Content-Type":"application/json"}}),_=(e,t)=>v()({method:"post",url:`${w}${e}`,data:t,transformRequest:[function(e){let t="";for(let a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}),k=(e,t)=>v()({method:"post",url:`${w}${e}`,data:t,headers:{"Content-Type":"multipart/form-data"}}),S=(e,t)=>v()({method:"put",url:`${w}${e}`,data:t,transformRequest:[function(e){let t="";for(let a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}),$=(e,t)=>v()({method:"delete",url:`${w}${e}`,data:t,transformRequest:[function(e){let t="";for(let a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}),C=(e,t)=>v()({method:"get",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:`${w}${e}`});var D=a(8960),T=a.n(D);const M=a(9575).Base64;var j={components:{Vcode:T()},data(){return{isShow:!1,mici:5,salt:"shz",id:0,checked:!0,loginForm:{username:"",password:""},loading:!1}},mounted(){this.account()},methods:{submit(){this.isShow=!0},success(e){this.isShow=!1,this.submitClick()},close(){this.isShow=!1},account(){document.cookie.length>=0&&(this.loginForm.username=this.getCookie("username"),this.loginForm.password=this.getCookie("password"))},setCookie(e,t,a){var s=new Date;s.setTime(s.getTime()+864e5*a),document.cookie="username="+e+";path=/;expires="+s.toGMTString(),document.cookie="password="+t+";path=/;expires="+s.toGMTString()},getCookie(e){for(var t=document.cookie.split(";"),a=0;a<t.length;a++){var s=t[a].split("=");if(s[0].trim()==e){for(var i=s[1],r=0;r<this.mici;r++)i=M.decode(i);var n=i.indexOf("|");return i.substring(0,n)}}},clearCookie(){this.setCookie("","",-1)},submitClick(){var e=this;if(this.loading=!0,1==e.checked){let t=e.loginForm.username+"|"+this.salt,a=e.loginForm.password+"|"+this.salt;for(let e=0;e<this.mici;e++)t=M.encode(t),a=M.encode(a);e.setCookie(t,a,7)}else e.clearCookie();_("/login",{username:this.loginForm.username,password:this.loginForm.password,rememberMe:this.checked}).then((t=>{if(e.loading=!1,200==t.status){localStorage.setItem("token",t.data.token);var a=t.data;"success"==a.status?e.$router.replace({path:"/home"}):e.$alert("用户名密码错误","失败!")}else e.$alert("登录失败!","失败!")}),(t=>{e.loading=!1,e.$alert("找不到服务器⊙﹏⊙∥!","失败!")}))}}},z=j,F=(0,o.Z)(z,p,g,!1,null,null,null),N=F.exports,A=function(){var e=this,t=e._self._c;return t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"loginForm",staticClass:"login-container",staticStyle:{"margin-top":"20px","margin-left":"20px"},attrs:{"label-position":"left","label-width":"0px",model:e.loginForm,rules:e.rules}},[t("h3",{staticClass:"login_title"},[e._v("邮箱登录")]),t("el-form-item",{attrs:{prop:"email"}},[t("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"邮箱"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email",t)},expression:"loginForm.email"}})],1),t("el-form-item",{attrs:{prop:"code"}},[t("span",[t("el-input",{staticStyle:{width:"130px"},attrs:{type:"text","auto-complete":"off",placeholder:"验证码"},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}})],1),e._v("   "),t("span",[t("el-button",{attrs:{disabled:e.time>0},on:{click:e.btnClick}},[e._v(" "+e._s(e.time>0?`${e.time}秒后可重新发送`:"点击发送")+" ")])],1)]),t("el-dialog",{attrs:{title:"邮箱登录注意事项",visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("p",[e._v(" 1. 如果此邮箱未使用密码注册过,将为您自动注册一个账号,您可以通过主页的个人信息修改您的电话号码或用户名等个人信息 ")]),t("p",[e._v(" 2. 如果此邮箱已经使用密码注册过,您邮箱登录的账号就为此账号,您仍能用密码登录 ")]),t("p",[e._v(" 3. 为了保证您的账号安全,验证码默认5分钟过期,请不要将验证码泄露给他人 ")]),t("p",[e._v("4. 由于服务器成本,您在1分钟以内肯定会收到验证码,请耐心等待")])]),t("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("已阅读注意事项")]),e._v(" "),t("span",{staticStyle:{color:"blue","text-decoration":"underline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("详情")]),t("Vcode",{attrs:{show:e.isShow},on:{success:e.success,close:e.close}}),t("el-form-item",{staticStyle:{width:"100%","margin-top":"12px"}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[e._v("登录")])],1)],1)},I=[],O={components:{Vcode:T()},data(){return{dialogVisible:!1,isShow:!1,time:0,why:"",checked:!1,loginForm:{email:"",code:""},rules:{email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{type:"string",message:"邮箱格式不正确",trigger:"blur",transform(e){if(!/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e))return!0}},{type:"string",message:"长度不能超过30位",trigger:"blur",max:30}]},loading:!1}},mounted(){},methods:{btnClick(){this.$refs["loginForm"].validate((e=>{if(!e)return!1;this.isShow=!0}))},submit(){if(!this.checked)return this.$message({type:"error",message:"请点击已阅读注意事项"}),!1;this.submitClick()},success(e){this.sendCode(),this.isShow=!1},close(){this.isShow=!1},sendCode(){this.$message({type:"success",message:"发送成功"}),this.time=120;const e=setInterval((()=>{this.time--,this.time<0&&clearInterval(e)}),1e3);_("/email/send",{email:this.loginForm.email,code:this.loginForm.code}).then((e=>{}))},submitClick(){var e=this;this.loading=!0,this.$refs["loginForm"].validate((t=>{if(!t)return this.loading=!1,!1;_("/email/login",{email:this.loginForm.email,code:this.loginForm.code}).then((t=>{if(e.loading=!1,200==t.status){var a=t.data;"success"==a.status?(e.$router.replace({path:"/home"}),sessionStorage.setItem("token",a.msg)):e.$alert(t.data.msg,"失败!")}else e.$alert("登录失败!","失败!")}),(t=>{e.loading=!1,e.$alert("找不到服务器⊙﹏⊙∥!","失败!")}))}))}}},V=O,P=(0,o.Z)(V,A,I,!1,null,null,null),B=P.exports,E={mounted:function(){var e=this.$route.query.over;1==e&&(this.$message.closeAll(),this.$message({type:"error",message:"您的账号在别处登录了,请确保您的账户是否被盗用!!!"}))},methods:{},data(){return{}},components:{login_table:N,email_login:B}},Y=E,R=(0,o.Z)(Y,m,h,!1,null,"64b6671e",null),Z=R.exports,U=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"home_container"},[t("el-aside",{attrs:{width:"200px"}},[t("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"background-color":"ghostwhite"},attrs:{"default-active":"0",router:""}},[e._l(this.$router.options.routes,(function(a,s){return a.hidden?e._e():[a.children.length>1?t("el-submenu",{key:s,attrs:{index:s+""}},[t("template",{slot:"title"},[t("i",{class:a.iconCls}),t("span",[e._v(e._s(a.name))])]),e._l(a.children,(function(a){return a.hidden?e._e():t("el-menu-item",{key:a.path,attrs:{index:a.path}},[e._v(" "+e._s(a.name)+" ")])}))],2):[t("el-menu-item",{attrs:{index:a.children[0].path}},[t("i",{class:a.children[0].iconCls}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(a.children[0].name))])])]]}))],2)],1),t("el-container",[t("el-header",{staticStyle:{height:"80px"}},[t("el-dialog",{attrs:{visible:e.yulan},on:{"update:visible":function(t){e.yulan=t}}},[t("viewer",[t("img",{attrs:{width:"100%",src:this.imgAvatar}})])],1),t("div",{staticClass:"home_title"},[e._v("外卖系统")]),t("div",{staticClass:"home_userinfoContainer"},[t("div",{staticStyle:{float:"left"}}),e._v("  "),t("i",{staticStyle:{"padding-right":"40px",color:"aliceblue"}},[e._v(" "+e._s(e.nowTime)+" ")]),t("el-dropdown",{on:{command:e.handleCommand}},[t("span",{staticStyle:{color:"white"}},[t("i",{staticStyle:{"padding-right":"20px"}},[e._v(" "+e._s(e.currentUserName)+" ")]),t("img",{attrs:{src:this.imgAvatar,width:"40",height:"40"},on:{click:function(t){e.yulan=!0}}}),t("i",{staticClass:"el-icon-arrow-down el-icon--right home_userinfo"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("router-link",{attrs:{to:"/MenuList"}},[t("el-dropdown-item",{staticStyle:{"text-decoration":"none"},attrs:{command:"diancai"}},[e._v("点菜大厅")])],1),t("router-link",{attrs:{to:"/ms"}},[t("el-dropdown-item",[e._v("个人信息")])],1),t("div",{on:{click:function(t){return e.toMsg()}}},[t("el-dropdown-item",[e._v("个人主页")])],1),t("el-dropdown-item",{attrs:{command:"logout",divided:""}},[e._v("退出登录")]),t("el-dropdown-item",{attrs:{command:"getTouxiang",divided:""}},[e._v("上传头像")])],1)],1)],1),t("el-dialog",{attrs:{title:"上传头像",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("avatar_cropper",{on:{closeAvatarDialog:e.closeAvatarDialog,avatar:e.getAvatar}}),t("el-button",{staticStyle:{"margin-left":"150px"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v("    "),t("el-button",{attrs:{type:"success"},on:{click:e.submitAvatar}},[e._v("确认上传")])],1)],1),t("el-container",[t("el-main",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",{domProps:{textContent:e._s(this.$router.currentRoute.name)}})],1),t("el-carousel",{directives:[{name:"show",rawName:"v-show",value:"首页"==this.$router.currentRoute.name,expression:"this.$router.currentRoute.name == '首页'"}],attrs:{interval:4e3,type:"card",height:"400px"}},e._l(e.imgUrls,(function(e){return t("el-carousel-item",{key:e},[t("img",{attrs:{src:e}})])})),1),t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):e._e()],1),this.$route.meta.keepAlive?e._e():t("router-view")],1)],1)],1)],1)},q=[],L=(a(7658),function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.model,expression:"model"}],staticClass:"model",on:{click:function(t){e.model=!1}}},[t("div",{staticClass:"model-show"},[t("img",{attrs:{src:e.modelSrc,alt:""}})])]),t("div",{staticClass:"content"},[t("div",{staticClass:"show-info"},[t("div",{staticClass:"test"},[t("vueCropper",{ref:"cropper2",attrs:{img:e.example2.img,outputSize:e.example2.size,outputType:e.example2.outputType,info:e.example2.info,canScale:e.example2.canScale,autoCrop:e.example2.autoCrop,autoCropWidth:e.example2.autoCropWidth,autoCropHeight:e.example2.autoCropHeight,fixed:e.example2.fixed,fixedNumber:e.example2.fixedNumber,enlarge:4}})],1),t("label",{staticClass:"btn",attrs:{for:"upload2"}},[e._v("上传")]),t("input",{staticStyle:{position:"absolute",clip:"rect(0 0 0 0)"},attrs:{type:"file",id:"upload2",accept:"image/png, image/jpeg, image/gif, image/jpg"},on:{change:function(t){return e.uploadImg(t,2)}}}),t("button",{staticClass:"btn",on:{click:function(t){return e.finish2()}}},[e._v("裁剪")])])])])}),H=[],K=(a(2801),a(3408),a(4590),a(4862)),G={components:{VueCropper:K.VueCropper},data(){return{oss:"http://shzzz.oss-cn-hangzhou.aliyuncs.com/",model:!1,modelSrc:"",crap:!1,previews:{},form:{head:""},example2:{img:"",info:!0,size:1,outputType:"jpeg",canScale:!0,autoCrop:!0,autoCropWidth:300,autoCropHeight:250,fixed:!0,infoTrue:!0,fixedNumber:[1,1]},downImg:"#"}},methods:{base64ToFile(e,t){let a=e.split(","),s=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,n=new Uint8Array(r);while(r--)n[r]=i.charCodeAt(r);return new File([n],t,{type:s})},finish2(){this.$refs.cropper2.getCropData((e=>{this.modelSrc=e,this.model=!1,this.example2.img=this.modelSrc;var t=this.base64ToFile(e,"avatar");this.upload(t)}))},upload(e){console.log(e);var t=new FormData,a=[];a.push(e),console.log(a),a.map((e=>{t.append("file",e)})),k("/upload/img",t).then((e=>{this.$emit("avatar",e.data.msg)}))},uploadImg(e,t){this.example2.img="";var a=e.target.files[0];if(!/\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(e.target.value))return alert("图片类型必须是.gif,jpeg,jpg,png,bmp中的一种"),!1;var s=new FileReader;s.onload=e=>{let a;a=e.target.result,console.log(e.target.result),a="object"===typeof e.target.result?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,1===t?this.option.img=a:2===t&&(this.example2.img=a)},s.readAsArrayBuffer(a),this.upload(a)}}},J=G,W=(0,o.Z)(J,L,H,!1,null,null,null),X=W.exports,Q={components:{avatar_cropper:X},methods:{toMsg(){this.$router.push({path:"/Example",query:{username:this.msg.username,phone:this.msg.phone,avatar:this.imgAvatar,email:this.msg.email,uid:this.msg.uid}})},getAvatar(e){this.avatar=e},submitAvatar(){S("/addAvatar",{avatar:this.avatar}).then((e=>{this.imgAvatar=e.data,this.dialogVisible=!1}))},closeAvatarDialog(e){this.dialogVisible=!1},timeFormate(e){let t=new Date(e).getFullYear(),a=new Date(e).getMonth()+1<10?"0"+(new Date(e).getMonth()+1):new Date(e).getMonth()+1,s=new Date(e).getDate()<10?"0"+new Date(e).getDate():new Date(e).getDate(),i=new Date(e).getHours()<10?"0"+new Date(e).getHours():new Date(e).getHours(),r=new Date(e).getMinutes()<10?"0"+new Date(e).getMinutes():new Date(e).getMinutes(),n=new Date(e).getSeconds()<10?"0"+new Date(e).getSeconds():new Date(e).getSeconds(),l=new Date(e).getDay(),o=["日","一","二","三","四","五","六"],c="星期"+o[l];this.nowTime=t+"年"+a+"月"+s+"日 "+i+":"+r+":"+n+c},nowTimes(){this.timeFormate(new Date),setInterval(this.nowTimes,1e3),this.clear()},clear(){clearInterval(this.nowTimes),this.nowTimes=null},beforeDestroy(){this.timer&&clearInterval(this.timer)},handleCommand(e){var t=this;"getTouxiang"==e&&(this.dialogVisible=!0),"logout"==e&&this.$confirm("注销登录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){C("/logout"),t.currentUserName="游客",t.$router.replace({path:"/"})}),(function(){}))}},mounted:function(){this.$store.dispatch("connect");var e=this;C("/img/homepageImg").then((t=>{e.imgUrls=t.data})),C("/myAvatar").then((t=>{e.imgAvatar=t.data}));e=this;this.nowTimes(),C("/currentUserName").then((t=>{"success"==t.data.status?e.currentUserName=t.data.msg:(e.$message({type:"error",message:"尚未登录,请先登录!"}),e.$router.replace({path:"/"}))})),C("/currentUserBasicMsg").then((e=>{this.msg=e.data,window.sessionStorage.setItem("user",JSON.stringify(e.data))}))},beforeDestroy(){this.clear()},data(){return{msg:{},yulan:!1,imgAvatar:"",avatar:"",dialogVisible:!1,imgUrls:[],currentUserName:"",nowTime:""}}},ee=Q,te=(0,o.Z)(ee,U,q,!1,null,null,null),ae=te.exports,se=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"menu_list"},[t("el-main",{staticClass:"main"},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick}},e._l(e.label,(function(a,s){return t("el-tab-pane",{key:s,attrs:{label:a}},[t("menu_table",{ref:"mclear",refInFor:!0,attrs:{state:e.states[s],category:a,sumPrice:e.sumPrice},on:{mget:e.mget}})],1)})),1)],1),t("el-footer",[e._l(e.sumTitle,(function(a,s){return t("el-tag",{key:s,staticStyle:{"margin-left":"20px"},attrs:{"disable-transitions":!1}},[e._v(" "+e._s(s+1+"、"+a)+" ")])})),t("el-dialog",{attrs:{title:"修改个人信息",width:"50%",top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.updatemsg}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.updatemsg.username,callback:function(t){e.$set(e.updatemsg,"username",t)},expression:"updatemsg.username"}})],1),t("el-form-item",{attrs:{label:"手机号"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.updatemsg.phone,callback:function(t){e.$set(e.updatemsg,"phone",t)},expression:"updatemsg.phone"}})],1),t("el-form-item",{attrs:{label:"联系地址"}},[t("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请选择或输入地址"},model:{value:e.curaddress,callback:function(t){e.curaddress=t},expression:"curaddress"}},e._l(e.updatemsg.addresses,(function(e,a){return t("el-option",{key:a,attrs:{value:e.address}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateAddress(e.curaddress)}}},[e._v("确 定")])],1)],1),t("el-descriptions",{attrs:{title:"用户信息"}},[t("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(e.usermsg.username))]),t("el-descriptions-item",{attrs:{label:"手机号"}},[e._v(e._s(e.usermsg.phone))]),t("el-descriptions-item",{attrs:{label:"联系地址"}},[e._v(e._s(e.firstaddress))])],1),t("div",{staticStyle:{"text-align":"left"}},[t("el-button",{attrs:{type:"text",icon:"el-icon-caret-right\n"},on:{click:function(t){return e.openDrawer()}}},[e._v(" 选择最近门店 ")]),e._v("   "),t("span",{directives:[{name:"show",rawName:"v-show",value:""!=this.getTransExp.name,expression:"this.getTransExp.name != ''"}]},[e._v("您选择的门店为:")]),t("span",{directives:[{name:"show",rawName:"v-show",value:""!=this.getTransExp.name,expression:"this.getTransExp.name != ''"}]},[e._v(e._s(e.getTransExp.name))]),t("span",{directives:[{name:"show",rawName:"v-show",value:""!=this.getTransExp.name,expression:"this.getTransExp.name != ''"}],staticStyle:{color:"blue"}},[e._v("运费")]),t("span",{directives:[{name:"show",rawName:"v-show",value:""!=this.getTransExp.name,expression:"this.getTransExp.name != ''"}],staticStyle:{color:"red"}},[e._v(e._s(e.getTransExp.exp))]),t("span",{directives:[{name:"show",rawName:"v-show",value:""!=this.getTransExp.name,expression:"this.getTransExp.name != ''"}]},[e._v("元")])],1),t("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,modal:!1},on:{"update:visible":function(t){e.drawer=t}}},[t("shop_list",{key:this.x+this.y,attrs:{x:e.x,y:e.y},on:{transExp:e.transExp}})],1),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.clearmenus}},[e._v("清空重新选菜")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.openPersonMessage}},[e._v("修改个人信息")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submitMenus}},[e._v("提交订单")]),t("el-button",{attrs:{type:"text"},on:{click:e.openVoucher}},[e._v("选择我的优惠券")]),t("span",{staticStyle:{"margin-left":"50px"}},[e._v("已优惠")]),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.discountSum))]),t("span",[e._v("元")]),t("i",{staticClass:"el-icon-d-arrow-right"}),t("i",{staticClass:"el-icon-d-arrow-right"}),t("i",{staticClass:"el-icon-d-arrow-right"}),t("span",{staticStyle:{"margin-left":"20px"}},[e._v("总计")]),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.sumPrice+e.transportMoney-e.discountSum<0?0:e.sumPrice+e.transportMoney-e.discountSum))]),t("span",[e._v("元")]),t("br"),t("br"),t("br")],2),t("el-dialog",{attrs:{title:"选择我的优惠券",visible:e.isVoucher,modal:!1},on:{"update:visible":function(t){e.isVoucher=t}}},[t("p",{directives:[{name:"show",rawName:"v-show",value:0==this.vouchers.length,expression:"this.vouchers.length == 0"}]},[e._v("暂无可用优惠券")]),t("el-checkbox-group",{on:{change:e.discount},model:{value:e.selectVouchers,callback:function(t){e.selectVouchers=t},expression:"selectVouchers"}},e._l(e.vouchers,(function(a,s){return t("el-checkbox-button",{key:s,attrs:{label:a.title}},[e._v(e._s(a.title)+" "),t("br"),t("br"),t("span",[e._v("优惠")]),t("span",[e._v(e._s(a.price))]),t("span",[e._v("元")])])})),1)],1)],1)},ie=[],re=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"通过菜品搜索该分类下的菜","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{staticStyle:{"margin-left":"3px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.searchClick}},[e._v("搜索 ")]),t("el-col",{attrs:{span:6}}),t("el-col",{staticStyle:{color:"black"},attrs:{span:2}},[e._v("原价总和")]),t("el-col",{staticStyle:{color:"red"},attrs:{span:1}},[e._v(e._s(e.sumPrice))]),t("el-col",{staticStyle:{color:"black"},attrs:{span:1}},[e._v("元")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%","overflow-x":"hidden","overflow-y":"hidden"},attrs:{data:e.menus,"row-key":e.getRowKey,"tooltip-effect":"dark","max-height":"390"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",selectable:e.checkboxSelect,width:"35",align:"left","reserve-selection":!0}}),t("el-table-column",{attrs:{label:"菜品",width:"200",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.itemClick(a.row)}}},[e._v(e._s(a.row.title))])]}}])}),t("el-table-column",{attrs:{label:"是否有货",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{directives:[{name:"show",rawName:"v-show",value:1==a.row.status,expression:"scope.row.status == true"}],staticStyle:{color:"green"}},[e._v("有货")]),t("span",{directives:[{name:"show",rawName:"v-show",value:0==a.row.status,expression:"scope.row.status == false"}],staticStyle:{color:"red"}},[e._v("缺货中")])]}}])}),t("el-table-column",{attrs:{label:"价格",width:"140",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.price))]}}])}),t("el-table-column",{attrs:{prop:"img",label:"图片",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{attrs:{src:e.row.location}})]}}])}),t("el-table-column",{attrs:{prop:"introduction",label:"介绍",width:"400",align:"center"}}),t("el-table-column",{attrs:{label:"份数",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{attrs:{disabled:1!=e.showadd[a.row.mid],min:1,max:10},on:{change:e.changeNum},model:{value:e.nums[a.row.mid],callback:function(t){e.$set(e.nums,a.row.mid,t)},expression:"nums[scope.row.mid]"}})]}}])})],1),t("div",{staticClass:"menu_table_footer"},[e._m(0),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.menus.length>0,expression:"menus.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)],1)},ne=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"menus"},[e._v("shao_菜馆 "),t("i",{staticClass:"el-icon-knife-fork"})])}],le={data(){return{values:[],menuIdMax:2e3,showadd:[],num:4,nums:[],menus:[],selItems:[],loading:!1,currentPage:1,totalCount:-1,pageSize:6,keywords:"",temp:0}},mounted:function(){this.loading=!0,this.loadMenus(1,this.pageSize)},methods:{checkboxSelect(e,t){return 1==e.status},changeNum(){this.handleSelectionChange(this.selItems)},getRowKey(e){return e.mid},deleteRow(){this.$refs.multipleTable.clearSelection()},searchClick(){this.loadMenus(1,this.pageSize)},itemClick(e){this.$router.push({path:"/MenuDetail",query:{mid:e.mid,img:e.location,category:this.category}})},currentChange(e){this.currentPage=e,this.loading=!0,this.loadMenus(e,this.pageSize)},loadMenus(e,t){var a=this,s="/menus/all?state="+this.state+"&page="+e+"&count="+t+"&keywords="+this.keywords;C(s).then((e=>{if(a.loading=!1,200==e.status){a.menus=e.data.menus,a.totalCount=e.data.totalCount;for(var t=0;t<a.menus.length;t++)this.nums[a.menus[t].mid]=1}}),(e=>{a.loading=!1,403==e.response.status&&a.$message({type:"error",message:e.response.data})})).catch((e=>{a.loading=!1}))},handleSelectionChange(e){this.selItems=e,this.showadd=[];for(var t={cost:0,price:0,mtf:[],state:this.state},a=0;a<this.selItems.length;a++){var s=[];s[0]=this.selItems[a].mid,s[1]=this.selItems[a].title,s[2]=this.nums[this.selItems[a].mid],t.mtf.push(s),t.price+=this.selItems[a].price*s[2],t.cost+=this.selItems[a].cost*s[2],this.showadd[this.selItems[a].mid]=1}this.$emit("mget",t)}},props:["state","sumPrice","category"]},oe=le,ce=(0,o.Z)(oe,re,ne,!1,null,null,null),de=ce.exports,ue=function(){var e=this,t=e._self._c;return t("div",[t("el-container",{staticClass:"menu_list"},[t("el-main",{staticClass:"main"},[t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"附近5km内"}},[t("shop_table",{attrs:{x:e.x,y:e.y,state:0},on:{transExp:e.transExp}})],1),t("el-tab-pane",{attrs:{label:"附近10km内"}},[t("shop_table",{attrs:{x:e.x,y:e.y,state:1},on:{transExp:e.transExp}})],1),t("el-tab-pane",{attrs:{label:"全部门店"}},[t("shop_table",{attrs:{x:e.x,y:e.y,state:2}})],1)],1)],1)],1)],1)},me=[],he=function(){var e=this,t=e._self._c;return t("div",[t("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticClass:"infinite-list",staticStyle:{overflow:"auto"},attrs:{"infinite-scroll-immediate":"false","infinite-scroll-distance":"1"}},e._l(e.arr,(function(a,s){return t("div",{key:s,staticClass:"infinite-list-item",staticStyle:{height:"100px","margin-top":"5px"}},[t("span",[e._v(e._s(a.name))]),t("br"),t("div",{directives:[{name:"show",rawName:"v-show",value:2!=e.state,expression:"state != 2"}]},[t("span",[e._v(e._s("距离我:"+(a.distance/1e3).toFixed(2)+" km"))]),e._v(" "),t("span",[e._v("运费为")]),t("span",{staticStyle:{color:"red"}},[e._v(e._s(2*(a.distance/1e3).toFixed(0)))]),t("span",[e._v("元")]),e._v("  "),t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.transExp(a)}}},[e._v("选择")])],1),t("el-divider")],1)})),0)])},pe=[],ge={mounted(){this.load()},data(){return{arr:[],msg:[1],start:1,count:3}},methods:{transExp(e){var t=(e.distance/1e3).toFixed(2),a=2*(e.distance/1e3).toFixed(0),s={name:e.name,distance:t,exp:a,gid:e.gid};this.$emit("transExp",s)},load(){var e=this;if(null==this.msg||0==this.msg.length)return!1;var t="";t=2==this.state?"/geo/aroundShop?state="+this.state+"&count="+this.count+"&start="+this.start:"/geo/aroundShop?x="+parseFloat(this.x)+"&y="+parseFloat(this.y)+"&start="+this.start+"&count="+this.count+"&state="+this.state,C(t).then((t=>{e.msg=t.data.list,e.start+=1;for(var a=0;a<e.msg.length;a++)this.arr.push(e.msg[a])}))}},props:["x","y","state"]},fe=ge,ve=(0,o.Z)(fe,he,pe,!1,null,"341d5c7c",null),be=ve.exports,ye={mounted:function(){console.log(this.x+","+this.y)},methods:{transExp(e){this.$emit("transExp",e)}},data(){return{}},components:{shop_table:be},props:["x","y"]},we=ye,xe=(0,o.Z)(we,ue,me,!1,null,"19342ac4",null),_e=xe.exports,ke={mounted:function(){for(var e=0;e<this.categoryIdMax;e++)this.menus.push(this.menus[0]);var t=this;C("/isAdmin").then((e=>{200==e.status&&(t.isAdmin=e.data)})),C("/admin/category/all").then((e=>{for(var a=e.data,s=[],i=[],r=0;r<a.length;r++)s.push(a[r].name),i.push(a[r].id);t.label=s,t.states=i})),C("/currentUserMsg").then((function(e){t.usermsg=e.data,console.log(e.data.addresses[0].address),t.firstaddress=e.data.addresses[0].address}),(function(e){}));var a="/geo/aroundShop?state=2";C(a).then((e=>{this.shops=e.data.list}))},data(){return{updatemsg:{username:"",phone:"",addresses:""},shops:[],getTransExp:{name:"",exp:"",distance:""},transportMoney:0,drawer:!1,direction:"rtl",msg:[],x:0,y:0,discountSum:0,curlen:0,vids:[],selectVouchers:[],vouchers:[],isVoucher:!1,categoryIdMax:500,states:[],label:[],sumTitle:[],menus:[{cost:0,price:0,mtf:[],state:-1}],centerDialogVisible:!1,sumPrice:0,sumCost:0,isAdmin:!1,usermsg:{username:"",phone:"",addresses:""},firstaddress:"",curaddress:"",dialogFormVisible:!1,formLabelWidth:"120px"}},methods:{openPersonMessage(){this.curaddress=this.firstaddress,Object.assign(this.updatemsg,this.usermsg),this.dialogFormVisible=!0},openVoucher(){C("/getMyVoucher").then((e=>{this.vouchers=e.data})),this.isVoucher=!0},transExp(e){this.getTransExp=e,this.transportMoney=this.getTransExp.exp,this.drawer=!1},openDrawer(){if(0==this.firstaddress.length)return this.$message({type:"error",message:"请输入地址"}),!1;C("/map/getSearch/"+this.firstaddress).then((e=>{if(this.msg=e.data.tips,null==this.msg||0==this.msg.length)return this.$message({type:"error",message:"请输入有效地址"}),!1;var t=this.msg[0].location;if(null==t||"undefined"==t||0==t.length)return this.$message({type:"error",message:"请输入更详细一些的地址"}),!1;console.log(t);var a=t.indexOf(",");this.x=t.substring(0,a),this.y=t.substring(a+1),this.drawer=!0}))},clearVoucher(){this.$message({type:"success",message:"优惠券选择太多,无法免单"})},discount(){var e=!0;this.selectVouchers.length<this.curlen&&(e=!1);var t=0,a=[];this.curlen=this.selectVouchers.length;for(var s=0;s<this.curlen;s++)for(var i=0;i<this.vouchers.length;i++)if(this.vouchers[i].title==this.selectVouchers[s]){a.push(this.vouchers[i].vid),t+=this.vouchers[i].price;break}this.vids=a,this.discountSum=t,e&&this.$message({type:"success",message:"已减免"+t+"元"})},mget(e){var t=e.state;this.menus[t]=e;var a=0,s=0;this.sumTitle=[];for(var i=0;i<this.categoryIdMax;i++){for(var r=0;r<this.menus[i].mtf.length;r++)this.sumTitle.push(this.menus[i].mtf[r][1]+"X"+this.menus[i].mtf[r][2]);a+=this.menus[i].price,s+=this.menus[i].cost}this.sumPrice=a,this.sumCost=s},clearmenus(){for(var e=0;e<20;e++)null!=this.$refs.mclear[e]&&this.$refs.mclear[e].deleteRow()},submitMenus(){if(this.sumPrice<this.discountSum||0==this.sumPrice)return this.$message({type:"error",message:"请先选择菜"}),!1;if(""==this.getTransExp.name)return this.$message({type:"error",message:"请选择门户"}),!1;var e=this;if(11!=e.usermsg.phone.length||0==e.firstaddress.length||0==e.usermsg.username.length)return e.$message({type:"error",message:"用户信息不得为空,请输入有效信息（电话号码为11位）"}),!1;this.$confirm("是否提交订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.loading=!0,$("/deleteMyVouchers",{vids:this.vids});var t=e.sumPrice-e.discountSum+e.transportMoney,a="";this.sumTitle.forEach((e=>{a+=e,a+="+"}));for(var s=a.substring(0,a.length-1),i=0;i<e.shops.length;i++)if(e.shops[i].name==e.getTransExp.name)break;x("/addOrder",{address:e.firstaddress,content:s,customer:e.usermsg.username,price:t,cost:e.sumCost,phone:e.usermsg.phone,gid:e.shops[i].gid,geoname:e.getTransExp.name,distance:e.getTransExp.distance}).then((a=>{if(200==a.status){var i=a.data.object;console.log(i);var r=-1==i?"下单失败":"下单成功";if(e.$message({type:a.data.status,message:r}),"success"==a.data.status){var n="";n=s.length>40?s.substring(0,40)+"...(剩下菜品请去我的订单查看)":s;var l=n,o=i,c="/alipay/pay?subject="+l+"&traceNo="+o+"&totalAmount="+t;C(c).then((e=>{window.open(`http://localhost:8081/alipay/pay?subject=${l}&traceNo=${o}&totalAmount=${t}`)})),this.clearmenus(),this.discount=0,this.transportMoney=0,this.getTransExp={name:"",exp:"",distance:""}}}else e.$message({type:"error",message:"提交失败!"});e.loading=!1}),(t=>{e.loading=!1,e.$message({type:"error",message:"提交失败!"})}))})).catch((()=>{e.$message({type:"info",message:"已取消提交"})}))},updateAddress(e){if(0==e.length)return this.$message({type:"error",message:"地址不得为空"}),!1;this.firstaddress=this.curaddress,Object.assign(this.usermsg,this.updatemsg);var t=this;_("/addOneAddress",{address:t.curaddress}).then((e=>{200==e.status&&("success"==e.data.status?this.$message({type:"success",message:"修改成功"}):this.$message({type:"error",message:"修改失败"}),this.getTransExp={name:"",exp:"",distance:""},this.dialogFormVisible=!1)}))},handleClick(){}},components:{menu_table:de,shop_list:_e}},Se=ke,$e=(0,o.Z)(Se,se,ie,!1,null,null,null),Ce=$e.exports,De=function(){var e=this,t=e._self._c;return t("div",[t("br"),t("el-dialog",{attrs:{title:"支付详情",visible:e.dialogFormVisible,width:"500px",modal:!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("span",[e._v("订单号:"+e._s(e.tradeNo))]),t("br"),t("span",[e._v("支付宝交易凭证号:"+e._s(e.aliPaytradeNo))]),t("br"),t("span",[e._v("买家付款时间:"+e._s(e.gmtPayment))])]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orders,"default-sort":{prop:"date",order:"descending"},border:!0,stripe:!0}},[t("el-table-column",{attrs:{prop:"publishDate",label:"订购日期",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.publishDate)))]}}])}),t("el-table-column",{attrs:{prop:"content",label:"订单",width:"320"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"220",trigger:"click"}},[t("span",[e._v(e._s(a.row.content))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.content.length>20?a.row.content.substr(0,20)+"...":a.row.content.substr(0,20)))])])]}}])}),t("el-table-column",{attrs:{prop:"expire",label:"支付情况",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.pay)+" ")]),t("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.payDetail(a.row)}}},[e._v("支付详情")])]}}])}),t("el-table-column",{attrs:{prop:"customer",label:"姓名",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.customer))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.customer.length>5?a.row.customer.substr(0,5)+"...":a.row.customer.substr(0,5)))])])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>12?a.row.address.substr(0,12)+"...":a.row.address.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"",width:"120"}}),t("el-table-column",{attrs:{prop:"geoname",label:"门店名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"150",trigger:"click"}},[t("span",[e._v(e._s(a.row.geoname))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.geoname.length>10?a.row.geoname.substr(0,10)+"...":a.row.geoname.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{prop:"distance",label:"离门店的距离(km)",width:"180",align:"center"}})],1),t("br"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.orders.length>0,expression:"this.orders.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)},Te=[],Me=a(381),je=a.n(Me),ze={mounted(){this.loading=!0,this.loadOrders(1,this.pageSize)},data(){return{dialogFormVisible:!1,aliPaytradeNo:"",gmtPayment:"",tradeNo:"",currentPage:1,totalCount:-1,pageSize:6,orders:[]}},methods:{payDetail(e){console.log(e),this.dialogFormVisible=!0,this.aliPaytradeNo=e.aliPaytradeNo,this.gmtPayment=e.gmtPayment,this.tradeNo=e.oid},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},formatter(e,t){return e.address},currentChange(e){this.currentPage=e,this.loading=!0,this.sumItems=this.selItems,this.loadOrders(e,this.pageSize)},loadOrders(e,t){var a=this,s="/myHistoryOrders?page="+e+"&count="+t;C(s).then((e=>{a.loading=!1,200==e.status&&(a.orders=e.data.orders,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1,403==e.response.status&&a.$message({type:"error",message:e.response.data})})).catch((e=>{a.loading=!1}))}}},Fe=ze,Ne=(0,o.Z)(Fe,De,Te,!1,null,"5bdc064f",null),Ae=Ne.exports,Ie=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-col",{attrs:{span:24}},[t("div",{staticStyle:{"text-align":"left"}},[t("el-button",{staticStyle:{"padding-bottom":"0px"},attrs:{type:"text",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回")])],1)]),t("div",{staticStyle:{display:"inline-block",float:"left","margin-left":"100px"}},[t("img",{attrs:{src:this.$route.query.img,width:"500",height:"500"}})]),t("div",{staticStyle:{display:"inline-block",width:"auto",height:"500px",float:"left"}},[t("el-dialog",{attrs:{title:"修改菜品信息",width:"50%",top:"5vh",visible:e.dialogFormVisible,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("span",[e._v("主料:")]),t("el-input",{staticStyle:{width:"200px"},attrs:{autocomplete:"off"},model:{value:e.zhuliao,callback:function(t){e.zhuliao=t},expression:"zhuliao"}}),t("span",[e._v("味道:")]),t("el-input",{staticStyle:{width:"200px"},attrs:{autocomplete:"off"},model:{value:e.weidao,callback:function(t){e.weidao=t},expression:"weidao"}}),t("br"),t("br"),t("span",[e._v("做菜方式:")]),t("el-input",{staticStyle:{width:"200px"},attrs:{autocomplete:"off"},model:{value:e.way,callback:function(t){e.way=t},expression:"way"}}),t("span",[e._v("做菜时间:")]),t("el-input",{staticStyle:{width:"200px"},attrs:{autocomplete:"off"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.updateMenuDetail}},[e._v("确 定")])],1)],1),t("el-descriptions",{staticStyle:{"margin-left":"20px"},attrs:{title:"菜品详情",direction:"vertical",column:4,labelStyle:{width:"160px",height:"68px"},contentStyle:{width:"160px",height:"75px"},border:""}},[t("template",{slot:"extra"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("操作")])],1),t("el-descriptions-item",{attrs:{label:"菜名",span:2}},[e._v(e._s(e.menu.title))]),t("el-descriptions-item",{attrs:{label:"主料"}},[e._v(e._s(e.zhuliao))]),t("el-descriptions-item",{attrs:{label:"味道"}},[e._v(e._s(e.weidao))]),t("el-descriptions-item",{attrs:{label:"菜品类型"}},[t("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.category))])],1),t("el-descriptions-item",{attrs:{label:"菜品价格"}},[t("span",{staticStyle:{color:"red"}},[e._v(e._s(e.menu.price+" "))]),t("span",[e._v("元")])]),t("el-descriptions-item",{attrs:{label:"做菜方式"}},[e._v(e._s(e.way))]),t("el-descriptions-item",{attrs:{label:"做菜时间"}},[e._v(e._s(e.time))]),t("el-descriptions-item",{attrs:{label:"菜品描述",span:2}},[e._v(e._s(e.menu.introduction)+" ")]),t("el-descriptions-item",{attrs:{label:"平均评分"}},[t("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value} 分"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),t("el-descriptions-item",{attrs:{label:"给出你的评分"}},[t("div",{staticClass:"block"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticStyle:{"margin-left":"25px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.rateThisMenu}},[e._v("评价")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{"margin-left":"60px"},attrs:{type:"info",size:"mini",disabled:!0}},[e._v("已评价")]),t("br"),t("br"),t("el-rate",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticStyle:{"margin-bottom":"5px",float:"left"},model:{value:e.point,callback:function(t){e.point=t},expression:"point"}}),t("el-rate",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{"margin-bottom":"5px"},attrs:{disabled:""},model:{value:e.myRate,callback:function(t){e.myRate=t},expression:"myRate"}})],1)])],2)],1)],1),t("br"),t("el-divider",{staticStyle:{"border-color":"red"}}),t("br"),t("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:10}},[t("el-input",{staticStyle:{width:"800px",float:"left"},attrs:{type:"text",placeholder:"添加评论"},model:{value:e.comment.content,callback:function(t){e.$set(e.comment,"content",t)},expression:"comment.content"}}),t("el-button",{staticStyle:{"margin-left":"20px",float:"left"},attrs:{type:"primary"},on:{click:e.addComment}},[e._v("添加评论 ")])],1),e._l(e.comments,(function(a,s){return t("div",{key:s,staticStyle:{"text-align":"left"}},[t("div",{staticClass:"commentCon"},[e._v(e._s(a.content))]),t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.formatDate(a.publishDate)))]),t("img",{staticStyle:{height:"30px",width:"30px"},attrs:{src:a.userDTO.avatar},on:{click:function(t){return e.toMsg(a.userDTO)}}}),t("span",{staticStyle:{color:"cornflowerblue"},on:{click:function(t){return e.toMsg(a.userDTO)}}},[e._v(e._s(a.userDTO.username))]),e._v("    "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.canShow(a.userDTO.username),expression:"canShow(comment.userDTO.username)"}],on:{click:function(t){return e.chehui(a.cid)}}},[e._v("撤回")]),t("el-divider",[t("i",{staticClass:"el-icon-s-platform"})])],1)})),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.comments.length>0,expression:"this.comments.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],2)},Oe=[],Ve={mounted:function(){this.loading=!0,this.category=this.$route.query.category,this.loadComments(this.currentPage,this.pageSize),C("/isAdmin").then((e=>{this.isAdmin=e.data})),C("/currentUserName").then((e=>{"success"==e.data.status&&(this.currentUserName=e.data.msg)})),C("/currentUserId").then((e=>{this.uid=e.data}));var e=this.$route.query.mid;C("/menus/getAMenu/"+e).then((e=>{this.menu=e.data})),this.average(),this.isRate(),this.getAMenuDetail()},methods:{getAMenuDetail(){C("/menus/getAMenuDetail/"+this.$route.query.mid).then((e=>{this.zhuliao=e.data.zhuliao,this.weidao=e.data.weidao,this.way=e.data.way,this.time=e.data.time}))},updateMenuDetail(){S("/menus/updateDetail",{weidao:this.weidao,zhuliao:this.zhuliao,way:this.way,time:this.time,mid:this.$route.query.mid}).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.getAMenuDetail(),this.dialogFormVisible=!1}))},average(){var e=this.$route.query.mid;C("/menus/average/"+e).then((e=>{console.log(e.data),this.value=parseFloat(e.data.toFixed(2))}))},isRate(){var e=this.$route.query.mid;C("/menus/isRate/"+e).then((e=>{this.isShow=e.data.isRate,this.isShow&&(this.myRate=e.data.myRate)}))},rateThisMenu(){var e=this.$route.query.mid;_("/menus/rate",{point:this.point,mid:e}).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.isRate(),this.average()}))},toMsg(e){this.$router.push({path:"/Example",query:{username:e.username,phone:e.phone,avatar:e.avatar,email:e.email,uid:e.uid}})},chehui(e){var t=this,a="/deleteMyThisComment",s=this.$route.query.mid;$(a,{cid:e,uid:t.uid,mid:s}).then((e=>{var a=e.data;"success"==a.status?(t.$message({type:"success",message:"删除成功"}),t.loadComments(this.currentPage,this.pageSize)):t.$message({type:"success",message:"删除失败"})}))},canShow(e){var t=this.currentUserName;return e==t},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},loadComments(e,t){var a=this.$route.query.mid,s=this;C("/getComments/"+a+"?page="+e+"&count="+t).then((e=>{200==e.status&&(s.comments=e.data.comments,s.totalCount=e.data.totalCount),s.loading=!1}),(e=>{s.loading=!1}))},currentChange(e){this.currentPage=e,this.loading=!0,this.loadComments(e,this.pageSize)},addComment(){var e=this.$route.query.mid,t=this;_("/addComment",{content:this.comment.content,mid:e}).then((e=>{t.loading=!1,200==e.status?"success"==e.data.status?(t.$message({type:"success",message:"发表成功"}),t.loadComments(this.currentPage,this.pageSize),t.comment.content=""):t.$message({type:"success",message:"发表失败"}):t.$alert(e.data.msg,"失败!")}),(e=>{t.loading=!1,t.$alert("找不到服务器⊙﹏⊙∥!","失败!")}))},goBack(){this.$router.go(-1)}},data(){return{dialogFormVisible:!1,isAdmin:!1,myRate:0,isShow:!1,value:0,point:0,zhuliao:"",weidao:"",way:"",time:"",category:"",menu:[],uid:-1,currentUserName:"",comment:{content:""},article:{},loading:!1,currentPage:1,pageSize:2,totalCount:-1,activeName:"",comments:{}}}},Pe=Ve,Be=(0,o.Z)(Pe,Ie,Oe,!1,null,"1292231a",null),Ee=Be.exports,Ye=function(){var e=this,t=e._self._c;return t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("span",{staticStyle:{"margin-left":"100px","font-size":"25px"}},[e._v("注册账号")]),t("br"),t("br"),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"phone"}},[t("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",{attrs:{model:e.ruleForm,label:"确认密码",prop:"checkPass"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.checkPass,callback:function(t){e.$set(e.ruleForm,"checkPass",t)},expression:"ruleForm.checkPass"}})],1),t("el-form-item",{attrs:{model:e.ruleForm,label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),t("el-radio-group",{staticStyle:{"margin-left":"100px"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[t("el-radio",{attrs:{label:0}},[e._v("用户")]),t("el-radio",{attrs:{label:1}},[e._v("骑手")]),t("el-radio",{attrs:{label:2}},[e._v("管理")])],1),t("br"),t("br"),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),t("el-button",{on:{click:e.goBack}},[e._v("返回")])],1)],1)},Re=[],Ze={data(){var e=(e,t,a)=>{""===t?a(new Error("请输入密码")):(""!==this.ruleForm.checkPass&&this.$refs.ruleForm.validateField("checkPass"),a())},t=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.ruleForm.password?a(new Error("两次输入密码不一致!")):a()};return{ruleForm:{password:"",username:"",phone:"",email:""},radio:0,rules:{email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{type:"string",message:"邮箱格式不正确",trigger:"blur",transform(e){if(!/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e))return!0}},{type:"string",message:"长度不能超过30位",trigger:"blur",max:30}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{min:11,max:11,message:"长度在11位",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],pass:[{validator:e,trigger:"blur"}],checkPass:[{validator:t,trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return t.$alert("找不到服务器！！！","失败"),!1;var t=this;_("/reg",{username:this.ruleForm.username,password:this.ruleForm.password,phone:this.ruleForm.phone,email:this.ruleForm.email,roleName:this.radio}).then((e=>{200==e.status?"success"==e.data.status?(t.$alert(e.data.msg,"成功"),t.$router.replace({path:"/"})):t.$alert(e.data.msg,"失败"):t.$alert("登陆失败","失败")}))}))},resetForm(e){this.$refs[e].resetFields()},goBack(){this.$router.replace({path:"/"})}}},Ue=Ze,qe=(0,o.Z)(Ue,Ye,Re,!1,null,"1252493c",null),Le=qe.exports,He=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"个人信息",visible:e.dialogVisible,width:"30%","close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticStyle:{"text-align":"left"}},[t("el-button",{staticStyle:{"padding-bottom":"0px"},attrs:{type:"text",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回")])],1)]),t("img",{attrs:{src:this.$route.query.img}})],1),t("br"),t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{label:"电话号码",prop:"phone"}},[t("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],attrs:{label:"原密码",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],attrs:{label:"新密码",prop:"curpassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.curpassword,callback:function(t){e.$set(e.ruleForm,"curpassword",t)},expression:"ruleForm.curpassword"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],attrs:{model:e.ruleForm,label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("修改")]),t("el-button",{on:{click:e.goBack}},[e._v("取消")])],1)],1)],1)},Ke=[],Ge={data(){return{isShow:!1,ruleForm:{username:"",password:"",curpassword:"",phone:"",email:""},dialogVisible:!0,rules:{email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{type:"string",message:"邮箱格式不正确",trigger:"blur",transform(e){if(!/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e))return!0}},{type:"string",message:"长度不能超过30位",trigger:"blur",max:30}],phone:[{required:!0,message:"请输入电话号码",trigger:"blur"},{min:11,max:11,message:"长度为11个字符",trigger:"blur"}],password:[{required:!1,message:"请输入原密码",trigger:"blur"},{min:3,max:11,message:"长度为3到11个字符",trigger:"blur"}],curpassword:[{required:!1,message:"请输入新密码",trigger:"blur"},{min:3,max:11,message:"长度为3到11个字符",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}]}}},mounted(){this.selectUserMsg(),C("/isExistPassword").then((e=>{this.isShow=e.data}))},methods:{selectUserMsg:function(){var e=this;C("/currentUserMsg").then((t=>{e.ruleForm=t.data}))},submitForm(e){if(console.log(this.ruleForm.curpassword),void 0==this.ruleForm.curpassword||void 0==this.ruleForm.password)return this.$message({type:"error",message:"密码不得为空"}),!1;var t=this;this.$refs[e].validate((e=>{if(!e)return!1;t.isShow?S("/updateMsg",{username:t.ruleForm.username,password:t.ruleForm.password,curpassword:t.ruleForm.curpassword,phone:t.ruleForm.phone,email:t.ruleForm.email}).then((e=>{200==e.status?"success"==e.data.status?(t.$alert(e.data.msg,"修改成功"),C("/logout"),t.currentUserName="游客",t.$router.replace({path:"/"})):t.$alert(e.data.msg,"失败"):t.$alert("找不到服务器！！！","失败")})):S("/updateMsg",{username:t.ruleForm.username,phone:t.ruleForm.phone,email:t.ruleForm.email}).then((e=>{200==e.status?"success"==e.data.status?(t.$alert(e.data.msg,"修改成功"),C("/logout"),t.currentUserName="游客",t.$router.replace({path:"/"})):t.$alert(e.data.msg,"失败"):t.$alert("找不到服务器！！！","失败")}))}))},goBack(){this.$router.go(-1)}}},Je=Ge,We=(0,o.Z)(Je,He,Ke,!1,null,null,null),Xe=We.exports,Qe=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isRider,expression:"isRider"}]},[t("br"),t("div",[t("el-button",{staticStyle:{float:"left"},attrs:{disabled:e.time>0},on:{click:e.btnClick}},[e._v(" "+e._s(e.time>0?`${e.time}秒后可重新点击`:"刷新列表")+" ")])],1),t("br"),e._v("     "),t("span",{staticStyle:{float:"left","margin-left":"20px"}},[e._v("上次刷新时间:"+e._s(e.thisTime))]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","overflow-x":"hidden","overflow-y":"hidden"},attrs:{data:e.orders,"tooltip-effect":"dark","default-sort":{prop:"date",order:"descending"}}},[t("el-table-column",{attrs:{prop:"publishDate",label:"订购日期",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.publishDate)))]}}])}),t("el-table-column",{attrs:{prop:"content",label:"订单",width:"240"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"220",trigger:"click"}},[t("span",[e._v(e._s(a.row.content))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.content.length>15?a.row.content.substr(0,15)+"...":a.row.content.substr(0,15)))])])]}}])}),t("el-table-column",{attrs:{prop:"limitTime",label:"预计时间(min)",width:"120",align:"center"}}),t("el-table-column",{attrs:{prop:"customer",label:"姓名",sortable:"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.customer))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.customer.length>5?a.row.customer.substr(0,5)+"...":a.row.customer.substr(0,5)))])])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话",width:"120"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>12?a.row.address.substr(0,12)+"...":a.row.address.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"",width:"80"}}),t("el-table-column",{attrs:{prop:"geoname",label:"门店名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"150",trigger:"click"}},[t("span",[e._v(e._s(a.row.geoname))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.geoname.length>12?a.row.geoname.substr(0,12)+"...":a.row.geoname.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"distance",label:"离门店的距离(km)",width:"135",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.jiedan(a.row)}}},[e._v("接单 ")])]}}])})],1),t("br"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.orders.length>0,expression:"this.orders.length > 0"}],staticStyle:{float:"right"},attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}}),t("br"),t("br"),t("el-container",[t("el-main",{staticStyle:{width:"100px"}},[t("el-tabs",[t("el-tab-pane",{attrs:{label:"我的接单（进行中）"}},[t("ride_table",{attrs:{state:"0"}})],1),t("el-tab-pane",{attrs:{label:"已完成订单"}},[t("ride_table",{attrs:{state:"1"}})],1)],1)],1)],1)],1)},et=[],tt=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","overflow-x":"hidden","overflow-y":"hidden"},attrs:{data:e.orders,"tooltip-effect":"dark","default-sort":{prop:"date",order:"descending"}}},[t("el-table-column",{attrs:{prop:"publishDate",label:"订购日期",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.publishDate)))]}}])}),t("el-table-column",{attrs:{prop:"content",label:"订单",width:"320"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"220",trigger:"click"}},[t("span",[e._v(e._s(a.row.content))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.content.length>20?a.row.content.substr(0,20)+"...":a.row.content.substr(0,20)))])])]}}])}),t("el-table-column",{attrs:{prop:"limitTime",label:"预计时间(min)",width:"120",align:"center"}}),t("el-table-column",{attrs:{prop:"customer",label:"姓名",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.customer))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.customer.length>5?a.row.customer.substr(0,5)+"...":a.row.customer.substr(0,5)))])])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话",width:"120"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>12?a.row.address.substr(0,12)+"...":a.row.address.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"",width:"110",align:"center"}}),0==e.state?t("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.songda(a.row)}}},[e._v("确认送达 ")])]}}],null,!1,1642305431)}):e._e()],1),t("br"),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}]},[e._v("总接单数:")]),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}],staticStyle:{color:"red"}},[e._v(e._s(e.totalCount))]),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}]},[e._v("单")]),e._v("     "),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}]},[e._v("本月接单数: ")]),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}],staticStyle:{color:"red"}},[e._v(e._s(e.mouthCount))]),t("span",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state==1"}]},[e._v("单")]),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.orders.length>0,expression:"this.orders.length > 0"}],staticStyle:{float:"right"},attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)},at=[],st={data(){return{loading:!1,currentPage:1,totalCount:-1,pageSize:6,orders:[],mouthCount:0}},mounted(){var e=this;this.loading=!0,this.loadOrders(1,this.pageSize),window.$bus.$on("OrderReload",(function(){e.loading=!0,e.loadOrders(e.currentPage,e.pageSize),1==e.state&&C("/rider/getMyMonthAchieved").then((t=>{e.mouthCount=t.data}))})),1==e.state&&C("/rider/getMyMonthAchieved").then((e=>{this.mouthCount=e.data}))},methods:{songda(e){var t=this;this.$confirm("是否确认送达","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0;var a="/rider/confirmOrder";S(a,{oid:e.oid}).then((e=>{if(200==e.status){var a=e.data;t.$message({type:a.status,message:a.msg}),"success"==a.status&&window.$bus.$emit("OrderReload")}else t.$message({type:"error",message:a.msg});t.loading=!1}),(e=>{t.loading=!1,t.$message({type:"error",message:"确认失败!"})}))})).catch((()=>{t.$message({type:"info",message:"已取消送达"})}))},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},formatter(e,t){return e.address},currentChange(e){this.currentPage=e,this.loading=!0,this.loadOrders(e,this.pageSize)},loadOrders(e,t){var a=this,s="";s=0==this.state?"/rider/getMyCurReceiveOrder?page="+e+"&count="+t:"/rider/getMyReceiveOrderAchieved?page="+e+"&count="+t,C(s).then((e=>{a.loading=!1,200==e.status&&(a.orders=e.data.orders,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1})).catch((e=>{a.loading=!1}))}},props:["state"]},it=st,rt=(0,o.Z)(it,tt,at,!1,null,null,null),nt=rt.exports,lt={mounted(){var e=this;this.loading=!0,this.thisTime=this.formatDate(),C("/isRider").then((t=>{200==t.status&&(e.isRider=t.data,0==e.isRider&&e.$message({type:"error",message:"您不是骑手"}))})),this.loadOrders(1,this.pageSize),window.$bus.$on("OrderReload",(function(){e.loading=!0,e.loadOrders(e.currentPage,e.pageSize)}))},data(){return{jiedanName:"我的接单（进行中）",state:[0,1],thisTime:0,isRider:!1,loading:!1,currentPage:1,totalCount:-1,pageSize:6,orders:[],time:0}},methods:{btnClick(){window.$bus.$emit("OrderReload"),this.time=5,this.thisTime=this.formatDate();const e=setInterval((()=>{this.time--,this.time<0&&clearInterval(e)}),1e3)},jiedan(e){var t=this;this.$confirm("是否接下这单","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0;var a="/rider/receiveOrder";S(a,{oid:e.oid}).then((e=>{if(200==e.status){var a=e.data;t.$message({type:a.status,message:a.msg}),"success"==a.status&&window.$bus.$emit("OrderReload")}else t.$message({type:"error",message:a.msg});t.loading=!1}),(e=>{t.loading=!1,t.$message({type:"error",message:"接单失败!"})}))})).catch((()=>{t.$message({type:"info",message:"已取消接单"})}))},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},formatter(e,t){return e.address},currentChange(e){this.currentPage=e,this.loading=!0,this.loadOrders(e,this.pageSize)},loadOrders(e,t){var a=this,s="/rider/getAllOrderNone?page="+e+"&count="+t;C(s).then((e=>{a.loading=!1,200==e.status&&(a.orders=e.data.orders,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1})).catch((e=>{a.loading=!1}))}},components:{ride_table:nt}},ot=lt,ct=(0,o.Z)(ot,Qe,et,!1,null,"9adc59cc",null),dt=ct.exports,ut=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[t("el-dialog",{attrs:{title:"新增菜品",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.menu}},[t("el-form-item",{attrs:{label:"菜名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.title,callback:function(t){e.$set(e.menu,"title",t)},expression:"menu.title"}})],1),t("el-form-item",{attrs:{label:"价格"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.price,callback:function(t){e.$set(e.menu,"price",t)},expression:"menu.price"}})],1),t("el-form-item",{attrs:{label:"成本"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.cost,callback:function(t){e.$set(e.menu,"cost",t)},expression:"menu.cost"}})],1),t("el-form-item",{attrs:{label:"介绍"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.introduction,callback:function(t){e.$set(e.menu,"introduction",t)},expression:"menu.introduction"}})],1),t("el-form-item",{attrs:{label:"菜品类型"}},[t("el-select",{attrs:{placeholder:"请选择菜品类型"},model:{value:e.curtype,callback:function(t){e.curtype=t},expression:"curtype"}},e._l(e.label,(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1)],1)],1),t("br"),t("p",{staticStyle:{"text-align":"left"}},[e._v("上传图片(限加一张)")]),t("br"),t("el-upload",{ref:"upload",attrs:{action:"","on-change":e.handleChange,"on-remove":e.handleRemove,"auto-upload":!1,"list-type":"picture-card",limit:1}},[t("i",{staticClass:"el-icon-plus"})]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:1==e.flag2},on:{click:function(t){return e.addMenu()}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"更改主页图片",visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[t("br"),t("p",{staticStyle:{"text-align":"left"}},[e._v("上传图片(限加五张)")]),t("br"),t("el-upload",{ref:"elupload",attrs:{action:"",limit:5,"on-remove":e.handleRemove2,"on-change":e.isDisable,"auto-upload":!1,"http-request":e.handleupload,"list-type":"picture-card"}},[t("i",{staticClass:"el-icon-plus"})]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:1==e.flag},on:{click:function(t){return e.uploadImgMany()}}},[e._v("确 定")])],1)],1),t("el-container",{staticClass:"menu_list"},[t("el-main",{staticClass:"main"},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.label,(function(a,s){return t("el-tab-pane",{key:s,attrs:{label:a,name:s+""}},[1==e.loadArr[s]?t("menu_table",{ref:"load",refInFor:!0,attrs:{state:e.states[s],category:a}}):e._e()],1)})),1)],1),t("el-footer",[t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增菜品")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.dialogFormVisible2=!0}}},[e._v("更改主页图片")]),t("br")],1)],1)],1)},mt=[],ht=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"修改菜品",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.menu}},[t("el-form-item",{attrs:{label:"菜名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.title,callback:function(t){e.$set(e.menu,"title",t)},expression:"menu.title"}})],1),t("el-form-item",{attrs:{label:"价格"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.price,callback:function(t){e.$set(e.menu,"price",t)},expression:"menu.price"}})],1),t("el-form-item",{attrs:{label:"成本"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.cost,callback:function(t){e.$set(e.menu,"cost",t)},expression:"menu.cost"}})],1),t("el-form-item",{attrs:{label:"介绍"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu.introduction,callback:function(t){e.$set(e.menu,"introduction",t)},expression:"menu.introduction"}})],1),t("el-form-item",{attrs:{label:"菜品类型"}},[t("el-select",{attrs:{placeholder:"请选择菜品类型"},model:{value:e.curtype,callback:function(t){e.curtype=t},expression:"curtype"}},e._l(e.label,(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateMenu()}}},[e._v("确 定")])],1)],1),t("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"通过菜品搜索该分类下的菜...","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{staticStyle:{"margin-left":"3px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.searchClick}},[e._v("搜索 ")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%","overflow-x":"hidden","overflow-y":"hidden"},attrs:{data:e.menus,"row-key":e.getRowKey,"tooltip-effect":"dark","max-height":"390","default-sort":{prop:"date",order:"ascending"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"35",align:"left","reserve-selection":!0}}),t("el-table-column",{attrs:{label:"菜品",width:"200",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.itemClick(a.row)}}},[e._v(e._s(a.row.title))])]}}])}),t("el-table-column",{attrs:{label:"价格",width:"140",align:"left",sortable:"",prop:"price"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.price))]}}])}),t("el-table-column",{attrs:{label:"成本",width:"140",align:"left",sortable:"",prop:"cost"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.cost))]}}])}),t("el-table-column",{attrs:{prop:"img",label:"图片",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{attrs:{src:e.row.location}})]}}])}),t("el-table-column",{attrs:{prop:"introduction",label:"介绍",width:"350",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])}),t("el-table-column",{attrs:{label:"是否有货",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.updateStatus(a.row)}},model:{value:e.values[a.row.mid],callback:function(t){e.$set(e.values,a.row.mid,t)},expression:"values[scope.row.mid]"}})]}}])})],1),t("div",{staticClass:"menu_table_footer"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:this.menus.length>0,expression:"this.menus.length > 0"}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除 ")]),t("span"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.menus.length>0,expression:"this.menus.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)],1)},pt=[],gt={data(){return{values:[],categoryIdMax:500,menuIdMax:2e3,stoLa:[],states:[],label:[],menus:[],selItems:[],loading:!1,currentPage:1,totalCount:-1,pageSize:8,keywords:"",dustbinData:[],curtype:"",menu:{title:"",price:"",cost:"",introduction:"",mid:"",location:""},dialogFormVisible:!1,dialogFormVisible:!1}},mounted:function(){this.loading=!0,this.loadMenus(1,this.pageSize);C("/admin/category/all").then((e=>{for(var t=e.data,a=0;a<t.length;a++)this.label.push(t[a].name),this.states.push(t[a].id),this.stoLa[t[a].id]=t[a].name}))},methods:{itemClick(e){this.$router.push({path:"/MenuDetail",query:{mid:e.mid,img:e.location,category:this.category}})},updateStatus(e){S("/menus/updateStatus",{mid:e.mid,status:this.values[e.mid]}).then((e=>{"success"==e.data&&this.$message({type:"success",message:e.data.msg})}))},updateMenu(){for(var e=this,t=0;t<this.label.length;t++)if(this.label[t]==e.curtype)break;S("/menus/updateThisMenus",{title:e.menu.title,price:e.menu.price,cost:e.menu.cost,introduction:e.menu.introduction,tid:e.states[t],mid:e.menu.mid,location:e.menu.location}).then((t=>{if(200==t.status){var a=t.data;"success"==a.status?(e.loadMenus(e.currentPage,e.pageSize),e.dialogFormVisible=!1,e.$message({type:a.status,message:a.msg})):e.$message({type:"error",message:a.msg})}else e.$message({type:"error",message:"输入信息不得为空"}),this.dialogFormVisible=!1;e.loading=!1}),(t=>{e.loading=!1,e.$message({type:"error",message:"输入信息不得为空!"})}))},getRowKey(e){return e.mid},deleteRow(){this.$refs.multipleTable.clearSelection()},searchClick(){this.loading=!0,this.currentPage=1,this.loadMenus(1,this.pageSize)},handleSelectionChange(e){this.selItems=e},handleEdit(e){this.dialogFormVisible=!0;var t=this;C("/menus/getAMenu/"+e.mid).then((e=>{t.loading=!1,200==e.status&&(t.menu=e.data,t.curtype=t.stoLa[this.state])}),(e=>{t.loading=!1,403==e.response.status&&t.$message({type:"error",message:e.response.data})})).catch((e=>{t.loading=!1}))},handleDelete(e,t){var a=this;this.$confirm("是否删除该类别下这个的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.loading=!0;var e="/menus/dustbinOne";$(e,{mid:t.mid}).then((e=>{if(200==e.status){var t=e.data;a.$message({type:t.status,message:t.msg}),"success"==t.status&&a.loadMenus(a.currentPage,a.pageSize)}else a.$message({type:"error",message:"删除失败!"});a.loading=!1}),(e=>{a.loading=!1,a.$message({type:"error",message:"删除失败!"})}))})).catch((()=>{a.$message({type:"info",message:"已取消删除"})}))},deleteMany(){for(var e=this.selItems,t=0;t<e.length;t++)this.dustbinData.push(e[t].mid);var a=this;this.$confirm("是否删除该类别下选中的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.loading=!0;var e="/menus/dustbin";$(e,{mids:a.dustbinData}).then((e=>{if(200==e.status){var t=e.data;a.$message({type:t.status,message:t.msg}),"success"==t.status&&(a.currentPage=1,a.loadMenus(a.currentPage,a.pageSize))}else a.$message({type:"error",message:"删除失败!"});a.loading=!1,a.dustbinData=[]}),(e=>{a.loading=!1,a.$message({type:"error",message:"删除失败!"}),a.dustbinData=[]}))})).catch((()=>{a.$message({type:"info",message:"已取消删除"}),a.dustbinData=[]}))},currentChange(e){this.currentPage=e,this.loading=!0,this.loadMenus(e,this.pageSize)},loadMenus(e,t){var a=this,s="/menus/all?state="+this.state+"&page="+e+"&count="+t+"&keywords="+this.keywords;C(s).then((e=>{if(a.loading=!1,200==e.status){a.menus=e.data.menus;for(var t=0;t<this.menus.length;t++)this.values[this.menus[t].mid]=this.menus[t].status;a.totalCount=e.data.totalCount}})).catch((e=>{a.loading=!1}))},deleteToDustBin(e){}},props:["state","category"]},ft=gt,vt=(0,o.Z)(ft,ht,pt,!1,null,null,null),bt=vt.exports,yt={mounted:function(){var e=this;C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data,0==e.isAdmin&&e.$message({type:"error",message:"您不是管理员"}))})),C("/admin/category/all").then((e=>{for(var t=e.data,a=0;a<t.length;a++)this.loadArr.push(0);this.loadArr[0]=1;for(a=0;a<t.length;a++)this.label.push(t[a].name),this.states.push(t[a].id)}))},data(){return{loadArr:[],activeName:"0",states:[],label:[],fileList:[],carousels:{},centerDialogVisible:!1,isAdmin:!1,flag:0,flag2:0,curtype:"",menu:{title:"",price:"",cost:"",introduction:""},dialogFormVisible:!1,dialogFormVisible2:!1,imgurl:"",imgurls:[]}},methods:{handleChange(e,t){var a=new FormData,s=this,i=e.size/1024/1024<10,r=e.name.lastIndexOf("."),n=e.name.substr(r+1);return-1=="jpg,jpeg,png".indexOf(n)?(s.$message.error("请上传正确的图片格式"),s.flag2=1,!1):i?(t.map((e=>{a.append("file",e.raw)})),void k("/upload/img",a).then((e=>{this.imgurl=e.data.msg}))):(s.flag2=1,s.$message.error("上传图片大小不能超过10MB哦!"),!1)},addMenu(){for(var e=this,t=0;t<this.label.length;t++)if(this.label[t]==this.curtype)break;x("/menus/addOne",{title:e.menu.title,price:e.menu.price,cost:e.menu.cost,introduction:e.menu.introduction,tid:e.states[t],location:e.imgurl}).then((a=>{if(200==a.status){var s=a.data;e.$message({type:s.status,message:s.msg}),"success"==s.status&&(this.$refs.upload.clearFiles(),this.menu=[],this.imgurl="",this.dialogFormVisible=!1,this.$refs.load[t].loadMenus(1,8))}else e.$message({type:s.status,message:s.msg});e.loading=!1}),(t=>{e.loading=!1,e.$message({type:"error",message:"输入信息不得为空,输入信息必须合法!"})}))},handleClick(e){for(var t=0;t<this.label.length;t++)if(e.label==this.label[t]){for(var a=0;a<this.label.length;a++)this.loadArr[a]=0;this.loadArr[t]=1;break}},handleRemove(e,t){0==this.flag2&&$("/upload/delete",{imgUrl:this.imgurl}),this.imgurl="",this.flag2=0},uploadImgMany(){let e=new FormData;if(this.$refs.elupload.submit(),0==this.fileList.length)return this.$message({type:"error",message:"图片不得为空"}),!1;this.$refs.elupload.clearFiles(),this.fileList.forEach((t=>{e.append("file",t)})),e.append("score",4),k("/upload/imgMany",e).then((e=>{this.fileList=[],this.dialogFormVisible2=!1,$("/img/deleteAll").then((t=>{_("/img/saveAll",{imgUrls:e.data}).then((e=>{this.$message({type:"success",message:"修改成功"})}))}))})),this.fileList=[]},handleupload(e){this.fileList.push(e.file)},isDisable(e){var t=this;if(1==this.flag)return t.$message.error("请检查已添加图片格式和大小"),!1;var a=e.size/1024/1024<10,s=e.name.substr(e.name.lastIndexOf(".")+1);return-1=="jpg,jpeg,gif,png".indexOf(s)?(t.$message.error("请上传正确的图片格式"),t.flag=1,!1):a?void 0:(t.flag=1,t.$message.error("上传图片大小不能超过10MB哦!"),!1)},handleRemove2(){this.$refs.elupload.submit();var e=!0;this.fileList.forEach((t=>{var a=t.size/1024/1024<10;-1==["image/jpeg","image/png"].indexOf(t.type)&&(e=!1),a||(e=!1)})),e&&(this.flag=0),this.fileList=[]}},components:{menu_table:bt}},wt=yt,xt=(0,o.Z)(wt,ut,mt,!1,null,null,null),_t=xt.exports,kt=function(){var e=this,t=e._self._c;return t("div",[t("br"),t("el-dialog",{attrs:{title:"支付详情",visible:e.dialogFormVisible,width:"500px",modal:!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("span",[e._v("订单号:"+e._s(e.tradeNo))]),t("br"),t("span",[e._v("支付宝交易凭证号:"+e._s(e.aliPaytradeNo))]),t("br"),t("span",[e._v("买家付款时间:"+e._s(e.gmtPayment))])]),t("el-dialog",{attrs:{title:"支付订单",visible:e.dialogFormVisible2,width:"500px",modal:!1,"append-to-body":!0},on:{"update:visible":function(t){e.dialogFormVisible2=t},close:e.closeExpire}},[t("span",[e._v("还剩")]),t("span",{staticStyle:{color:"red"}},[e._v(e._s(e.min))]),e._v("分钟:"),t("span",{staticStyle:{color:"red"}},[e._v(e._s(e.sec))]),t("span",[e._v("秒 将自动取消订单")]),t("br"),t("span",[e._v("订单:"+e._s(e.rowData.content))]),t("br"),t("span",[e._v("订购时间:"+e._s(e.formatDate(e.rowData.publishDate)))]),t("br"),t("br"),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.payMoney(e.rowData)}}},[e._v("支付宝入口")])],1),t("el-table",{attrs:{data:e.orders,"default-sort":{prop:"date",order:"descending"},border:!0,"cell-style":e.cellStyle,stripe:!0}},[t("el-table-column",{attrs:{prop:"publishDate",label:"订购日期",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.publishDate)))]}}])}),t("el-table-column",{attrs:{prop:"content",label:"订单",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"220",trigger:"hover"}},[t("span",[e._v(e._s(a.row.content))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.content.length>10?a.row.content.substr(0,10)+"...":a.row.content.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{prop:"expire",label:"支付情况",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.pay)+" ")]),t("span",{directives:[{name:"show",rawName:"v-show",value:"已支付"==a.row.pay,expression:"scope.row.pay == '已支付'"}],staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.payDetail(a.row)}}},[e._v("支付详情")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:"未支付"==a.row.pay,expression:"scope.row.pay == '未支付'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.openGo(a.row)}}},[e._v("去支付")])]}}])}),t("el-table-column",{attrs:{prop:"limitTime",label:"预计时间",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"customer",label:"姓名",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.customer))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.customer.length>5?a.row.customer.substr(0,5)+"...":a.row.customer.substr(0,5)))])])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话",width:"125"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>12?a.row.address.substr(0,12)+"...":a.row.address.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"",width:"100"}}),t("el-table-column",{attrs:{prop:"geoname",label:"门店名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.geoname))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.geoname.length>10?a.row.geoname.substr(0,10)+"...":a.row.geoname.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{prop:"distance",label:"离门店的距离(km)",width:"160",align:"center"}})],1)],1)},St=[],$t={mounted(){this.loading=!0;for(var e=0;e<this.curOrderMax;e++)this.timeArr.push(this.timeArr[0]);this.loadOrders(1,this.pageSize)},data(){return{loading:!1,flag:!1,dialogFormVisible2:!1,dialogFormVisible:!1,currentPage:1,totalCount:-1,pageSize:6,orders:[],day:0,hr:0,min:0,sec:0,time:0,aliPaytradeNo:"",gmtPayment:"",tradeNo:"",expire:-1,rowData:[]}},methods:{closeExpire(){this.expire=-1,this.flag=!0},openGo(e){setTimeout((()=>{this.flag=!1,this.dialogFormVisible2=!0,this.rowData=e,-1==this.expire&&C("/getAExpire/"+e.oid).then((e=>{this.expire=e.data,this.countdown(this.expire)}))}),100)},payDetail(e){console.log(e),this.dialogFormVisible=!0,this.aliPaytradeNo=e.aliPaytradeNo,this.gmtPayment=e.gmtPayment,this.tradeNo=e.oid},payMoney(e){var t="";t=e.content.length>40?e.content.substring(0,40)+"...(剩下菜品请去我的订单查看)":e.content;var a=t,s=e.oid,i="/alipay/pay?subject="+a+"&traceNo="+s+"&totalAmount="+e.price;C(i).then((t=>{window.open(`http://localhost:8081/alipay/pay?subject=${a}&traceNo=${s}&totalAmount=${e.price}`),this.dialogFormVisible2=!1,this.$alert("请尽快完成付款,如果您已完成付款,忽略这条消息","提示",{confirmButtonText:"知道了",callback:e=>{this.loadOrders(this.currentPage,this.pageSize)}})}))},cellStyle(e,t,a,s){return"支付情况"===e.column.label&&"已支付"==e.row.pay?"color:green":"支付情况"===e.column.label&&"未支付"==e.row.pay?"color:red":void 0},countdown(e){if(this.flag)return;if(e<0)return this.$message({type:"error",message:"该订单因为在30分钟内未支付已被系统取消,请重新下单"}),this.loadOrders(),void(this.dialogFormVisible2=!1);let t=parseInt(e/1e3/60/60/24),a=parseInt(e/1e3/60/60%24),s=parseInt(e/1e3/60%60),i=parseInt(e/1e3%60);if(this.day=t,this.hr=a>9?a:"0"+a,this.min=s>9?s:"0"+s,this.sec=i>9?i:"0"+i,this.flag)return;const r=this;if(s>=0&&i>=0){if(s<=0&&i<=0)return this.dialogFormVisible2=!1,void this.loadOrders();if(this.flag)return;setTimeout((function(){r.countdown(e-100)}),100)}},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},formatter(e,t){return e.address},loadOrders(e,t){var a=this,s="/getMyOrders";C(s).then((e=>{a.loading=!1,200==e.status&&(a.orders=e.data.orders,a.time=e.data.orders.limitTime,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1,403==e.response.status&&a.$message({type:"error",message:e.response.data})})).catch((e=>{a.loading=!1}))}}},Ct=$t,Dt=(0,o.Z)(Ct,kt,St,!1,null,null,null),Tt=Dt.exports,Mt=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[t("el-select",{staticStyle:{width:"500px","margin-right":"20px"},attrs:{placeholder:"默认为搜索全部门店的订单信息,请选择一个门店"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},e._l(e.shops,(function(a,s){return t("el-option",{key:s,attrs:{value:a.name}},[e._v(e._s(a.name))])})),1),t("el-select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{placeholder:"请选择一种状态"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.type,(function(a,s){return t("el-option",{key:s,attrs:{value:a}},[e._v(e._s(a))])})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")]),t("el-button",{attrs:{type:"info"},on:{click:e.clearsearch}},[e._v("重置")]),t("br"),t("br"),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orders,"default-sort":{prop:"date",order:"descending"},"cell-style":e.cellStyle}},[t("el-table-column",{attrs:{prop:"publishDate",label:"订购日期",sortable:"",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.publishDate)))]}}])}),t("el-table-column",{attrs:{prop:"content",label:"订单",width:"320"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"220",trigger:"click"}},[t("span",[e._v(e._s(a.row.content))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.content.length>20?a.row.content.substr(0,20)+"...":a.row.content.substr(0,20)))])])]}}])}),t("el-table-column",{attrs:{prop:"customer",label:"姓名",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.customer))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.customer.length>4?a.row.customer.substr(0,4)+"...":a.row.customer.substr(0,4)))])])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话",width:"120"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"top-start",width:"138",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>12?a.row.address.substr(0,12)+"...":a.row.address.substr(0,12)))])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"",width:"100"}}),t("el-table-column",{attrs:{prop:"limitTime",label:"预计时间",sortable:"",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"状态",width:"80",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.type[t.row.status]))]}}])}),t("el-table-column",{attrs:{label:"接单人信息",width:"320",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("接单人姓名:"+e._s(t.row.user.username)+" 接单人电话:"+e._s(t.row.user.phone))]}}])})],1),t("br"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.orders.length>0,expression:"orders.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)},jt=[],zt={mounted(){var e=this;this.loading=!0,C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data,0==e.isAdmin&&e.$message({type:"error",message:"您不是管理员"}))})),this.loadOrders(1,this.pageSize,this.keyword),this.timer?clearInterval(this.timer):this.timer=setInterval((()=>{this.queryInfo()}),5e3);var t="/geo/aroundShop?state=2";C(t).then((e=>{this.shops=e.data.list}))},data(){return{value:"",shops:[],keyword:"",currentPage:1,totalCount:-1,pageSize:6,orders:[],type:["暂未配送","配送中","已送达"],timer:null,isAdmin:!1}},destroyed(){clearInterval(this.timer)},methods:{clearsearch(){this.keyword="",this.value="",this.loadOrders(this.currentPage,this.pageSize)},search(){this.loadOrders(1,this.pageSize)},queryInfo(){this.loadOrders(this.currentPage,this.pageSize)},cellStyle(e,t,a,s){return"状态"===e.column.label&&1==e.row.status?"color:blue":"状态"===e.column.label&&2==e.row.status?"color:green":"状态"===e.column.label&&0==e.row.status?"color:red":void 0},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},formatter(e,t){return e.address},currentChange(e){this.currentPage=e,this.loading=!0,this.sumItems=this.selItems,this.loadOrders(e,this.pageSize)},loadOrders(e,t){for(var a=0;a<this.type.length;a++)if(this.value==this.type[a])break;a==this.type.length&&(a=-1);var s=this,i="/manage/getAllOrders?page="+e+"&count="+t+"&keyword="+this.keyword+"&status="+a;C(i).then((e=>{s.loading=!1,200==e.status&&(s.orders=e.data.orders,s.totalCount=e.data.totalCount)}),(e=>{s.loading=!1})).catch((e=>{s.loading=!1}))}}},Ft=zt,Nt=(0,o.Z)(Ft,Mt,jt,!1,null,null,null),At=Nt.exports,It=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[t("el-select",{staticStyle:{width:"500px","margin-right":"20px"},attrs:{placeholder:"默认为搜索全部门店的营业额和利润,请选择一个门店"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},e._l(e.shops,(function(a,s){return t("el-option",{key:s,attrs:{value:a.name}},[e._v(e._s(a.name))])})),1),t("el-select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{placeholder:"请选择年份(默认为今年)"},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}},e._l(e.yearArr,(function(a,s){return t("el-option",{key:s,attrs:{value:a}},[e._v(e._s(a+"年"))])})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")]),t("el-button",{attrs:{type:"info"},on:{click:e.clearsearch}},[e._v("重置")]),t("br"),t("br"),t("div",{staticClass:"view-content"},[t("div",{style:{width:"700px",height:"350px",display:"inline-block"},attrs:{id:"myChart"}}),t("div",{style:{width:"700px",height:"350px",display:"inline-block"},attrs:{id:"myChart2"}})]),t("el-divider"),t("el-select",{staticStyle:{width:"500px","margin-right":"20px"},attrs:{placeholder:"默认为搜索全部门店的营业额和利润,请选择一个门店"},model:{value:e.keyword2,callback:function(t){e.keyword2=t},expression:"keyword2"}},e._l(e.shops,(function(a,s){return t("el-option",{key:s,attrs:{value:a.name}},[e._v(e._s(a.name))])})),1),t("el-select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{placeholder:"请选择年份(默认为今年)"},model:{value:e.year2,callback:function(t){e.year2=t},expression:"year2"}},e._l(e.yearArr,(function(a,s){return t("el-option",{key:s,attrs:{value:a}},[e._v(e._s(a+"年"))])})),1),t("el-select",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{placeholder:"请选择月份(默认为这个月)"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}},e._l(12,(function(a,s){return t("el-option",{key:s,attrs:{value:a}},[e._v(e._s(a+"月"))])})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.daySearch}},[e._v("搜索")]),t("el-button",{attrs:{type:"info"},on:{click:e.clearsearch2}},[e._v("重置")]),t("br"),t("br"),t("div",{staticClass:"view-content",style:{width:"1600px",height:"350px"},attrs:{id:"myChart3"}}),t("div",{staticClass:"view-content",style:{width:"1600px",height:"350px"},attrs:{id:"myChart4"}}),t("el-divider"),t("span",{staticClass:"demonstration"},[e._v("选择日期范围")]),e._v("   "),t("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00"]},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}}),e._v("   "),t("el-button",{on:{click:e.what}},[e._v("查询")]),t("i",{staticClass:"el-icon-info",on:{click:e.open2}}),t("br"),t("br"),t("span"),e._v(" 营业额:"),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.sumPrice)+" ")]),e._v("元 "),t("br"),e._v(" 利润:"),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.profit)+" ")]),e._v("元 "),t("br"),t("br"),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:!0}},[t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t("el-table-column",{attrs:{prop:"count",label:"完成单数"}})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.userList.length>0,expression:"userList.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)},Ot=[],Vt={mounted:function(){var e=this;this.loading=!0,C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data,0==e.isAdmin&&e.$message({type:"error",message:"您不是管理员"}))}));var t="/geo/aroundShop?state=2";C(t).then((e=>{this.shops=e.data.list}));var a=(new Date).getFullYear();this.yearArr.push(a),this.yearArr.push(a-1),this.yearArr.push(a-2),this.year=a,this.year2=a,this.month=(new Date).getMonth()+1,this.search(),this.daySearch()},data(){return{x:[],keyword2:"",year2:"",sumOrder2:[],sumMonthPrice:[],sumMonthProfit:[],month:"",yearArr:[],year:"",keyword:"",sumOrder:[],sumYearPrice:[],sumYearProfit:[],shops:[],value1:[],loading:!1,currentPage:1,pageSize:3,totalCount:-1,userList:[],sumPrice:"",profit:"",isAdmin:!1,why:[1,2,3]}},methods:{clearsearch2(){this.keyword2="",this.daySearch()},daySearch(){var e="";if(""==this.keyword2)e="/manage/getMoneyOfMonth?year="+this.year2+"&month="+this.month;else{for(var t=0;t<this.shops.length;t++)if(this.shops[t].name==this.keyword2)break;e="/manage/getMoneyOfMonth?year="+this.year2+"&month="+this.month+"&gid="+this.shops[t].gid}this.sumMonthPrice=[],this.sumMonthProfit=[],this.sumOrder2=[],this.x=[],C(e).then((e=>{console.log(e.data.length);for(var t=0;t<e.data.length;t++)this.x.push(this.month+"-"+(t+1)),this.sumMonthPrice.push(e.data[t].sumPrice),this.sumMonthProfit.push(e.data[t].profit),this.sumOrder2.push(e.data[t].totalCount);this.drawLine3(this.sumMonthPrice,this.sumMonthProfit),this.drawLine4(this.sumOrder2)}))},clearsearch(){this.keyword="",this.search()},search(){var e="";if(""==this.keyword)e="/manage/getMoneyOfYear?year="+this.year;else{for(var t=0;t<this.shops.length;t++)if(this.shops[t].name==this.keyword)break;e="/manage/getMoneyOfYear?year="+this.year+"&gid="+this.shops[t].gid}this.sumYearPrice=[],this.sumOrder=[],this.sumYearProfit=[],C(e).then((e=>{for(var t=0;t<e.data.length;t++)this.sumYearPrice.push(e.data[t].sumPrice),this.sumYearProfit.push(e.data[t].profit),this.sumOrder.push(e.data[t].totalCount);this.drawLine(this.sumYearPrice,this.sumYearProfit),this.drawLine2(this.sumOrder)}))},drawLine(e,t){let a=this.$echarts.init(document.getElementById("myChart"));console.log(a);let s={color:"#c23531",title:{text:"年营业额利润表",padding:[20,20,100,100]},toolbox:{padding:[10,60,100,100],show:!0,feature:{mark:{show:!0},dataView:{show:!0,title:"数据视图",readOnly:!0,lang:["年营业额利润表","关闭","刷新"],backgroundColor:"#f4ebc8",textareaColor:"#f7f3e3",textareaBorderColor:"#333",textColor:"#000",buttonColor:"#c23531",buttonTextColor:"#fff"},dataZoom:{yAxisIndex:"none"},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},zlevel:0,z:2,left:"center",top:"top",right:"auto",bottom:"auto",width:"auto",height:"auto"}},tooltip:{},xAxis:{data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},yAxis:{},series:[{name:"营业额",type:"bar",data:e,color:"#c23531"},{name:"利润",data:t,type:"bar",barGap:"-100%",color:"green"}]};a.setOption(s)},drawLine2(e){let t=this.$echarts.init(document.getElementById("myChart2")),a={color:"#c23531",title:{text:"年销量表",padding:[20,20,100,100]},toolbox:{padding:[10,60,100,100],show:!0,feature:{mark:{show:!0},dataView:{show:!0,title:"数据视图",readOnly:!0,lang:["年销量表","关闭","刷新"],backgroundColor:"#f4ebc8",textareaColor:"#f7f3e3",textareaBorderColor:"#333",textColor:"#000",buttonColor:"#c23531",buttonTextColor:"#fff"},dataZoom:{yAxisIndex:"none"},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},zlevel:0,z:2,left:"center",top:"top",right:"auto",bottom:"auto",width:"auto",height:"auto"}},tooltip:{},xAxis:{data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},yAxis:{},series:[{name:"订单量",type:"bar",data:e,color:"#c23531"}]};t.setOption(a)},drawLine3(e,t){console.log(this.x);let a=this.$echarts.init(document.getElementById("myChart3")),s={color:"#c23531",title:{text:"月营业额利润表",padding:[20,20,100,200]},toolbox:{padding:[10,160,100,100],show:!0,feature:{mark:{show:!0},dataView:{show:!0,title:"数据视图",readOnly:!0,lang:["月营业额利润表","关闭","刷新"],backgroundColor:"#f4ebc8",textareaColor:"#f7f3e3",textareaBorderColor:"#333",textColor:"#000",buttonColor:"#c23531",buttonTextColor:"#fff"},dataZoom:{yAxisIndex:"none"},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},zlevel:0,z:2,left:"center",top:"top",right:"auto",bottom:"auto",width:"auto",height:"auto"}},tooltip:{},xAxis:{axisLabel:{show:!0,textStyle:{color:"#142468"},rotate:30},data:this.x},yAxis:{},series:[{name:"营业额",type:"bar",data:e,color:"#c23531"},{name:"利润",data:t,type:"bar",barGap:"-100%",color:"green"}]};a.setOption(s)},drawLine4(e){let t=this.$echarts.init(document.getElementById("myChart4")),a={color:"#c23531",title:{text:"月销量表",padding:[20,20,100,200]},toolbox:{padding:[10,160,100,100],show:!0,feature:{mark:{show:!0},dataView:{show:!0,title:"数据视图",readOnly:!0,lang:["月销量表","关闭","刷新"],backgroundColor:"#f4ebc8",textareaColor:"#f7f3e3",textareaBorderColor:"#333",textColor:"#000",buttonColor:"#c23531",buttonTextColor:"#fff"},dataZoom:{yAxisIndex:"none"},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},zlevel:0,z:2,left:"center",top:"top",right:"auto",bottom:"auto",width:"auto",height:"auto"}},tooltip:{},xAxis:{axisLabel:{show:!0,textStyle:{color:"#142468"},rotate:30},data:this.x},yAxis:{},series:[{name:"销量",type:"bar",data:e,color:"#c23531"}]};t.setOption(a)},open2(){this.$notify({title:"提示",message:"可以用来查询这段时间骑手完成的订单数,和总的营业额，利润",duration:0})},what(){this.loadMenus(this.currentPage,this.pageSize)},currentChange(e){this.currentPage=e,this.loading=!0,this.loadMenus(e,this.pageSize)},loadMenus(e,t){var a=this,s="/manage/whatMoney?startDate="+this.value1[0]+"&endDate="+this.value1[1]+"&page="+e+"&count="+t;C(s).then((e=>{a.loading=!1,200==e.status&&(a.userList=e.data.userList,a.profit=e.data.profit,a.sumPrice=e.data.sumPrice,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1,403==e.response.status&&a.$message({type:"error",message:e.response.data})})).catch((e=>{a.loading=!1}))}}},Pt=Vt,Bt=(0,o.Z)(Pt,It,Ot,!1,null,null,null),Et=Bt.exports,Yt=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",{staticClass:"cate_mana_header"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入菜品种类名称"},model:{value:e.cateName,callback:function(t){e.cateName=t},expression:"cateName"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"medium"},on:{click:e.addNewCate}},[e._v("新增菜品种类")])],1),t("el-main",{staticClass:"cate_mana_main"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.categories,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"编号",prop:"id",type:"index",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"菜品分类名称",prop:"name",width:"120",align:"center"}}),t("el-table-column",{attrs:{prop:"createTime",label:"启用时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])})],1),this.categories.length>0?t("el-button",{staticStyle:{"margin-top":"10px",width:"100px",float:"left"},attrs:{type:"danger",disabled:0==this.selItems.length},on:{click:e.deleteAll}},[e._v("批量删除 ")]):e._e()],1)],1)},Rt=[],Zt={mounted(){this.loading=!0,this.refresh();var e=this;C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data)}))},methods:{formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},addNewCate(){this.loading=!0;var e=this;return this.categories.length>=this.maxLimitCategory?(this.$message({type:"error",message:"菜品种类已达上限"}),e.loading=!1,!1):0==this.cateName.length||-1!="        ".indexOf(this.cateName)?(this.$message({type:"error",message:"菜品种类名不得为空"}),e.loading=!1,!1):this.cateName.length>=6?(this.$message({type:"error",message:"菜品种类名长度不得超过5个"}),e.loading=!1,!1):e.isAdmin?void _("/admin/category/add",{name:this.cateName}).then((t=>{if(200==t.status){var a=t.data;e.$message({type:a.status,message:a.msg}),e.cateName="",e.refresh()}e.loading=!1})):(this.$message({type:"error",message:"权限不足,请联系管理员!!!"}),void(e.loading=!1))},deleteAll(){var e=this;this.$confirm("确认删除这 "+this.selItems.length+" 条数据?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{for(var t=e.selItems,a="",s=0;s<t.length;s++)a+=t[s].id+",";e.deleteCate(a.substring(0,a.length-1))})).catch((()=>{e.loading=!1}))},handleSelectionChange(e){this.selItems=e},handleEdit(e,t){var a=this;this.$prompt("请输入新名称","编辑",{confirmButtonText:"更新",inputValue:t.name,cancelButtonText:"取消"}).then((({value:e})=>{if(null==e||0==e.length)a.$message({type:"info",message:"数据不能为空!"});else{if(a.loading=!0,!a.isAdmin)return this.$message({type:"error",message:"权限不足,请联系管理员!!!"}),void(a.loading=!1);S("/admin/category/update",{id:t.id,name:e}).then((e=>{var t=e.data;a.$message({type:t.status,message:t.msg}),a.refresh()}),(e=>{403==e.response.status&&a.$message({type:"error",message:"权限不足,请联系管理员"}),a.loading=!1}))}}))},handleDelete(e,t){let a=this;this.$confirm("确认删除 "+t.name+" ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.deleteCate(t.id)})).catch((()=>{a.loading=!1}))},deleteCate(e){var t=this;this.loading=!0,$("/admin/category/delete/"+e).then((e=>{var a=e.data;t.$message({type:a.status,message:a.msg}),t.refresh()}),(e=>{t.loading=!1,403==e.response.status?t.$message({type:"error",message:"权限不足,请联系管理员"}):500==e.response.status&&t.$message({type:"error",message:"该栏目下尚有文章，删除失败!"})}))},refresh(){let e=this;C("/admin/category/all").then((t=>{e.categories=t.data,e.loading=!1}))}},data(){return{isAdmin:!1,maxLimitCategory:10,cateName:"",selItems:[],categories:[],loading:!1}}},Ut=Zt,qt=(0,o.Z)(Ut,Yt,Rt,!1,null,null,null),Lt=qt.exports,Ht=function(){var e=this,t=e._self._c;return t("div",[t("el-header",{staticClass:"cate_mana_header"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:this.isAdmin,expression:"this.isAdmin"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增优惠券")])],1),t("div",{staticStyle:{display:"flex","justify-content":"space-around","flex-wrap":"wrap"}},e._l(e.vouchers,(function(a,s){return t("el-card",{key:s,staticStyle:{width:"330px","margin-top":"10px"},attrs:{"body-style":{padding:"0px"},span:8}},[t("img",{staticClass:"image",attrs:{src:a.imgUrl}}),t("div",{staticStyle:{padding:"14px"}},[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(a.title))]),t("p",[e._v(e._s(a.description))]),t("el-col",{staticStyle:{color:"red"},attrs:{span:24}},[e._v("开始抢购时间: "+e._s(e.formatDate(a.createTime)))]),t("el-col",{staticStyle:{color:"red"},attrs:{span:24}},[e._v("结束抢购时间: "+e._s(e.formatDate(a.endTime)))]),t("el-row",[t("el-col",{staticStyle:{"margin-left":"90px"},attrs:{span:4}},[e._v("还剩")]),t("el-col",{staticStyle:{color:"crimson"},attrs:{span:2}},[e._v(e._s(a.stock))]),t("el-col",{attrs:{span:2}},[e._v("张")]),e._v("   ")],1),t("el-row",[t("el-col",{staticStyle:{"margin-left":"90px"},attrs:{span:8}},[e._v("优惠券金额")]),t("el-col",{staticStyle:{color:"red"},attrs:{span:2}},[e._v(e._s(a.price))]),t("el-col",{attrs:{span:2}},[e._v("元")]),e._v("   ")],1),t("el-col",{staticStyle:{color:"blueviolet"},attrs:{span:24}},[e._v("使用截止到期时间: "+e._s(e.formatDate(a.deadTime)))]),t("br"),t("br"),t("el-button",{attrs:{type:"success",disabled:1!=e.timeIn[a.vid]},on:{click:function(t){return e.seckill(a.vid)}}},[e._v("抢购")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger"},on:{click:function(t){return e.deleteOne(a.vid)}}},[e._v("删除优惠券")]),t("p",{directives:[{name:"show",rawName:"v-show",value:1!=e.timeIn[a.vid],expression:"timeIn[o.vid] != 1"}],staticStyle:{color:"red"}},[e._v(" 当前时间不在抢购时间段内 ")])],1)])})),1),t("el-dialog",{attrs:{title:"新增优惠券",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",[t("el-form-item",{attrs:{label:"优惠券名称"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.voucher.title,callback:function(t){e.$set(e.voucher,"title",t)},expression:"voucher.title"}})],1),t("el-form-item",{attrs:{label:"优惠券描述"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.voucher.description,callback:function(t){e.$set(e.voucher,"description",t)},expression:"voucher.description"}})],1),t("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"发放优惠券数量"}},[t("el-input-number",{attrs:{min:10,max:500,label:""},model:{value:e.voucher.stock,callback:function(t){e.$set(e.voucher,"stock",t)},expression:"voucher.stock"}})],1),t("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"单张优惠券金额"}},[t("el-input-number",{attrs:{min:1,max:20,label:"优惠券数量"},model:{value:e.voucher.price,callback:function(t){e.$set(e.voucher,"price",t)},expression:"voucher.price"}})],1),t("p",{staticStyle:{"text-align":"left"}},[e._v("选择日期范围")]),t("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00"]},model:{value:e.voucher.dates,callback:function(t){e.$set(e.voucher,"dates",t)},expression:"voucher.dates"}},[t("p",{staticStyle:{"text-align":"left"}},[e._v("选择抢购日期")])]),t("p",{staticStyle:{"text-align":"left"}},[e._v("选择结束使用日期")]),t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),t("br"),t("p",{staticStyle:{"text-align":"left"}},[e._v("上传图片(限加一张)")]),t("br"),t("el-upload",{ref:"upload",attrs:{action:"","on-change":e.handleChange,"on-remove":e.handleRemove,"auto-upload":!1,"list-type":"picture-card",limit:1}},[t("i",{staticClass:"el-icon-plus"})]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:1==e.flag2},on:{click:function(t){return e.addVoucher()}}},[e._v("确 定")])],1)],1)],1)},Kt=[],Gt={provide(){return{reload:this.reload}},data(){return{isRouterAlive:!0,isAdmin:!1,loading:!1,imgurl:"",value1:"",timeIn:[],timeStart:[],timeEnd:[],voucher:{dates:[],price:1,stock:10,title:"",description:""},dialogFormVisible:!1,flag2:0,vouchers:""}},mounted(){this.loadVoucher(),window.$bus.$on("tableReload",(()=>{this.loadVoucher()}));var e=this;C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data)}))},methods:{reload(){this.$nextTick((()=>{this.isRouterAlive=!0}))},seckill(e){if(console.log(new Date),(new Date).getTime()<new Date(this.timeStart[e]).getTime()&&(new Date).getTime()>new Date(this.timeEnd[e]).getTime())return this.$message({type:"error",message:"当前时间不在抢购时间段内"}),!1;_("/seckill/"+e).then((e=>{var t=e.data;"success"==t.status?(this.$message({type:"success",message:t.msg+",点击‘选择我的优惠券’查看"}),this.$router.push({path:"/MenuList",query:{isVoucher:!0}})):this.$message({type:"error",message:t.msg})}))},deleteOne(e){var t=this;this.$confirm("是否删除该优惠券","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0,$("/deleteVoucher",{vid:e}).then((e=>{var t=e.data;"success"==t.status?(this.$message({type:"success",message:"删除成功"}),this.loadVoucher()):this.$message({type:"error",message:"删除失败"})}))})).catch((()=>{t.$message({type:"info",message:"已取消删除"})}))},loadVoucher(){C("/allVoucher").then((e=>{this.vouchers=e.data;for(var t=0;t<this.vouchers.length;t++){var a=this.vouchers[t].createTime,s=this.vouchers[t].endTime;this.timeStart[this.vouchers[t].vid]=a,this.timeEnd[this.vouchers[t].vid]=s,(new Date).getTime()>=new Date(a).getTime()&&(new Date).getTime()<=new Date(s).getTime()&&(this.timeIn[this.vouchers[t].vid]=1)}}))},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},addVoucher(){if(void 0==this.voucher.title||void 0==this.voucher.description)return this.$message({type:"error",message:"输入不得为空"}),!1;if(void 0==this.voucher.dates[0]||void 0==this.voucher.dates[1]||void 0==this.value1)return this.$message({type:"error",message:"所有日期时间不得为空"}),!1;if(new Date(this.voucher.dates[1]).getTime()>new Date(this.value1).getTime())return this.$message({type:"error",message:"使用日期截止时间应该在抢购日期截止时间之后"}),!1;if(""==this.imgurl)return this.$message({type:"error",message:"图片不得为空"}),!1;var e=this;e.loading=!0,_("/addVoucher",{title:e.voucher.title,stock:e.voucher.stock,description:e.voucher.description,createTime:this.formatDate(e.voucher.dates[0]),endTime:this.formatDate(e.voucher.dates[1]),deadTime:this.formatDate(e.value1),imgUrl:this.imgurl,price:this.voucher.price}).then((t=>{if(200==t.status){var a=t.data;"success"==a.status?(this.$refs.upload.clearFiles(),e.voucher=[],e.imgurl="",e.value1="",e.loadVoucher(),e.$message({type:a.status,message:a.msg}),this.dialogFormVisible=!1,this.imgurl=""):e.$message({type:a.status,message:a.msg})}e.loading=!1}),(t=>{e.loading=!1,e.$message({type:"error",message:"输入信息不得为空,输入信息必须合法!"})}))},handleRemove(e,t){0==this.flag2&&$("/upload/delete",{imgUrl:this.imgurl}),this.imgurl="",this.flag2=0},handleChange(e,t){this.$forceUpdate();var a=new FormData,s=this,i=e.size/1024/1024<10,r=e.name.lastIndexOf("."),n=e.name.substr(r+1);return-1=="jpg,jpeg,png".indexOf(n)?(s.$message.error("请上传正确的图片格式"),s.flag2=1,!1):i?(console.log(e),t.map((e=>{a.append("file",e.raw)})),console.log(a),void k("/upload/img",a).then((e=>{this.imgurl=e.data.msg}))):(s.flag2=1,s.$message.error("上传图片大小不能超过10MB哦!"),!1)}}},Jt=Gt,Wt=(0,o.Z)(Jt,Ht,Kt,!1,null,null,null),Xt=Wt.exports,Qt=function(){var e=this,t=e._self._c;return t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"post-article"},[t("el-header",{staticClass:"header"},[t("el-input",{staticStyle:{width:"400px","margin-left":"10px"},attrs:{placeholder:"请输入标题..."},model:{value:e.blog.blogTitle,callback:function(t){e.$set(e.blog,"blogTitle",t)},expression:"blog.blogTitle"}}),t("el-select",{staticStyle:{"margin-left":"40px"},attrs:{placeholder:"请选择代码风格"},model:{value:e.curStyle,callback:function(t){e.curStyle=t},expression:"curStyle"}},e._l(e.codeStyle,(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1)],1),t("el-main",{staticClass:"main"},[t("div",{attrs:{id:"editor"}},[t("mavon-editor",{ref:"md",staticStyle:{height:"100%",width:"100%"},attrs:{ishljs:!0,externalLink:e.externalLink,codeStyle:e.curStyle},on:{imgAdd:e.imgAdd,imgDel:e.imgDel},model:{value:e.blog.mdContent,callback:function(t){e.$set(e.blog,"mdContent",t)},expression:"blog.mdContent"}})],1),t("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"15px","justify-content":"flex-end"}},[void 0!=e.from?t("el-button",{on:{click:e.cancelEdit}},[e._v("放弃修改")]):e._e(),void 0!=e.from?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveBlog()}}},[e._v("保存修改")]):e._e(),void 0==e.from?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveBlog()}}},[e._v("发表博客")]):e._e()],1)])],1)},ea=[],ta=a(3067);const aa=(...e)=>{for(var t=0;t<e.length;t++){var a=e[t];if(null==a||""==a||void 0==a)return!1}return!0};var sa={mounted:function(){var e=this.$route.query.from;console.log(e),this.from=e,null!=e&&""!=e&&void 0!=e&&C("/blog/getABlog/"+e).then((e=>{this.blog=e.data,this.curStyle=this.blog.code}))},components:{mavonEditor:ta.mavonEditor},methods:{cancelEdit(){this.$router.go(-1)},saveBlog(){if(this.blog.blogContent=this.$refs.md.d_render,aa(this.blog.blogTitle,this.blog.blogContent)){var e=this;e.loading=!0;var t="";void 0==this.from?(t="/blog/saveBlog",x(t,{blogTitle:e.blog.blogTitle,blogContent:e.blog.blogContent,mdContent:e.blog.mdContent,code:this.curStyle}).then((t=>{e.loading=!1,"success"==t.data.status&&this.$router.replace({path:"/BlogList"}),e.$message({type:t.data.status,message:t.data.msg})}))):(t="/blog/updateBlog",S(t,{bid:e.blog.bid,blogTitle:e.blog.blogTitle,blogContent:e.blog.blogContent,mdContent:e.blog.mdContent,liked:e.blog.liked,code:this.curStyle,uid:e.blog.uid}).then((t=>{e.loading=!1,this.$router.replace({path:"/BlogList"}),e.$message({type:t.data.status,message:t.data.msg})})))}else this.$message({type:"error",message:"数据不能为空!"})},imgAdd(e,t){var a=this,s=new FormData;s.append("file",t),k("/upload/img",s).then((t=>{a.$refs.md.$img2Url(e,this.oss+t.data.msg)})).catch((e=>{}))},imgDel(e){}},data(){return{curStyle:"",codeStyle:["agate","vs","monokai","idea","dark","github","ocean","androidstudio","xcode"],externalLink:{markdown_css:function(){return"mavon-editor/markdown/github-markdown.min.css"},hljs_js:function(){return"/mavon-editor/highlightjs/highlight.min.js"},hljs_css:function(e){return"/mavon-editor/highlightjs/styles/"+e+".min.css"},hljs_lang:function(e){return"/mavon-editor/highlightjs/languages/"+e+".min.js"},katex_css:function(){return"/mavon-editor/katex/katex.min.css"},katex_js:function(){return"/mavon-editor/katex/katex.min.js"}},loading:!1,from:"",search:"",oss:"http://shzzz.oss-cn-hangzhou.aliyuncs.com/",blog:{bid:-1,blogContent:"",blogTitle:"",mdContent:"",liked:0,uid:0}}}},ia=sa,ra=(0,o.Z)(ia,Qt,ea,!1,null,null,null),na=ra.exports,la=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"menu_list"},[t("el-main",{staticClass:"main"},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.load}},[t("el-tab-pane",{attrs:{label:"博客大厅"}},[t("blog_table",{ref:"reload",attrs:{state:0}})],1),t("el-tab-pane",{attrs:{label:"我的博客"}},[t("MyBlogTableVue",{ref:"my",attrs:{state:1}})],1)],1)],1)],1)},oa=[],ca=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[t("el-input",{staticStyle:{width:"400px","margin-left":"auto"},attrs:{placeholder:"通过博客名称搜索该分类下的博客","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.searchClick}},[e._v("搜索 ")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.blogs,"row-key":e.getRowKey},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{label:"最近修改日期",prop:"date",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"点赞博客",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("i",{on:{click:function(t){return e.loveVote(a.row)}}},[e._v(e._s(a.row.like?"♥":"♡"))]),e._v(" "+e._s(a.row.liked)+" ")]}}])}),t("el-table-column",{attrs:{label:"博客名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.itemClick(a.row)}}},[e._v(e._s(a.row.blogTitle))])]}}])}),t("el-table-column",{attrs:{prop:"user.username",label:"作者",width:"400",align:"center"}}),1==e.state?t("el-table-column",{attrs:{type:"selection",width:"60",align:"left","reserve-selection":!0}}):e._e(),t("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state == 1"}],attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state == 1"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("br"),t("div",{staticClass:"menu_table_footer"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:this.blogs.length>0&&1==this.state,expression:"this.blogs.length > 0 && this.state == 1"}],staticStyle:{"margin-right":"1115px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除 ")]),t("br"),t("span"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.blogs.length>0,expression:"this.blogs.length > 0"}],staticStyle:{float:"center"},attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)],1)},da=[],ua={mounted(){var e=this;window.$bus.$on("TableReload",(()=>{e.loadBlogs(e.currentPage,e.pageSize)})),this.loadBlogs(this.currentPage,this.pageSize)},data(){return{dustbinData:[],blogs:[],loading:!1,currentPage:1,totalCount:-1,pageSize:6,keywords:"",selItems:[],search:""}},methods:{reload(){this.loadBlogs(this.currentPage,this.pageSize)},loveVote(e){e.like?e.liked-=1:e.liked+=1,e.like=!e.like,_("/blog/likeBlog",{bid:e.bid}).then((e=>{}))},deleteMany(){for(var e=this.selItems,t=0;t<e.length;t++)this.dustbinData.push(e[t].bid);var a=this;this.$confirm("是否删除该类别下选中的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.loading=!0;var e="/blog/dustbin";$(e,{bids:a.dustbinData}).then((e=>{if(200==e.status){var t=e.data;a.$message({type:t.status,message:t.msg}),"success"==t.status&&(a.currentPage=1,a.loadBlogs(a.currentPage,a.pageSize))}else a.$message({type:"error",message:"删除失败!"});a.loading=!1,a.dustbinData=[]}),(e=>{a.loading=!1,a.$message({type:"error",message:"删除失败!"}),a.dustbinData=[]}))})).catch((()=>{a.$message({type:"info",message:"已取消删除"}),a.dustbinData=[]}))},currentChange(e){this.currentPage=e,this.loading=!0,this.loadBlogs(e,this.pageSize)},searchClick(){this.loadBlogs(1,this.pageSize)},itemClick(e){this.$router.push({path:"/BlogDetail",query:{blog:e,bid:e.bid,username:e.user.username,phone:e.user.phone,email:e.user.email,avatar:e.user.avatar}})},guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)}))},getRowKey(e){return e.bid},loadBlogs(e,t){var a="";a=0==this.state?"/blog/all?page="+e+"&count="+t+"&keywords="+this.keywords:"/blog/getMyBlogs?page="+e+"&count="+t+"&keywords="+this.keywords,C(a).then((e=>{this.totalCount=e.data.totalCount,this.blogs=e.data.blogs,this.loading=!1}))},handleSelectionChange(e){this.selItems=e},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},handleEdit(e){this.$router.push({path:"/PostBlog",query:{from:e.bid}})},handleDelete(e){var t=this;this.$confirm("是否删除该类别下选中的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0;$("/blog/dustbinOne",{bid:e.bid}).then((e=>{if(200==e.status){var a=e.data;t.$message({type:a.status,message:a.msg}),"success"==a.status&&window.$bus.$emit("TableReload")}else t.$message({type:"error",message:"删除失败!"});t.loading=!1,t.dustbinData=[]}),(e=>{t.loading=!1,t.$message({type:"error",message:"删除失败!"}),t.dustbinData=[]}))})).catch((()=>{t.$message({type:"info",message:"已取消删除"}),t.dustbinData=[]}))}},props:["state"]},ma=ua,ha=(0,o.Z)(ma,ca,da,!1,null,null,null),pa=ha.exports,ga=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[t("el-input",{staticStyle:{width:"400px","margin-left":"auto"},attrs:{placeholder:"通过博客名称搜索该分类下的博客","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.searchClick}},[e._v("搜索 ")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.blogs,"row-key":e.getRowKey},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{label:"最近修改日期",prop:"date",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"点赞博客",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("i",{on:{click:function(t){return e.loveVote(a.row)}}},[e._v(e._s(a.row.like?"♥":"♡"))]),e._v(" "+e._s(a.row.liked)+" ")]}}])}),t("el-table-column",{attrs:{label:"博客名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return e.itemClick(a.row)}}},[e._v(e._s(a.row.blogTitle))])]}}])}),t("el-table-column",{attrs:{prop:"user.username",label:"作者",width:"400",align:"center"}}),1==e.state?t("el-table-column",{attrs:{type:"selection",width:"60",align:"left","reserve-selection":!0}}):e._e(),t("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state == 1"}],attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"state == 1"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("br"),t("div",{staticClass:"menu_table_footer"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:this.blogs.length>0&&1==this.state,expression:"this.blogs.length > 0 && this.state == 1"}],staticStyle:{"margin-right":"1115px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除 ")]),t("br"),t("span"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.blogs.length>0,expression:"this.blogs.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.currentChange}})],1)],1)},fa=[],va={mounted(){var e=this;window.$bus.$on("TableReload",(()=>{e.loadBlogs(e.currentPage,e.pageSize)})),this.loadBlogs(this.currentPage,this.pageSize)},data(){return{dustbinData:[],blogs:[],loading:!1,currentPage:1,totalCount:-1,pageSize:6,keywords:"",selItems:[],search:""}},methods:{reload(){this.loadBlogs(this.currentPage,this.pageSize)},loveVote(e){e.like?e.liked-=1:e.liked+=1,e.like=!e.like,_("/blog/likeBlog",{bid:e.bid}).then((e=>{}))},deleteMany(){for(var e=this.selItems,t=0;t<e.length;t++)this.dustbinData.push(e[t].bid);var a=this;this.$confirm("是否删除该类别下选中的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.loading=!0;var e="/blog/dustbin";$(e,{bids:a.dustbinData}).then((e=>{if(200==e.status){var t=e.data;a.$message({type:t.status,message:t.msg}),"success"==t.status&&(a.currentPage=1,a.loadBlogs(a.currentPage,a.pageSize))}else a.$message({type:"error",message:"删除失败!"});a.loading=!1,a.dustbinData=[]}),(e=>{a.loading=!1,a.$message({type:"error",message:"删除失败!"}),a.dustbinData=[]}))})).catch((()=>{a.$message({type:"info",message:"已取消删除"}),a.dustbinData=[]}))},currentChange(e){this.currentPage=e,this.loading=!0,this.loadBlogs(e,this.pageSize)},searchClick(){this.loadBlogs(1,this.pageSize)},itemClick(e){this.$router.push({path:"/BlogDetail",query:{blog:e,bid:e.bid,username:e.user.username,phone:e.user.phone,email:e.user.email,avatar:e.user.avatar}})},guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)}))},getRowKey(e){return e.bid},loadBlogs(e,t){var a="";a=0==this.state?"/blog/all?page="+e+"&count="+t+"&keywords="+this.keywords:"/blog/getMyBlogs?page="+e+"&count="+t+"&keywords="+this.keywords,C(a).then((e=>{this.totalCount=e.data.totalCount,this.blogs=e.data.blogs,this.loading=!1}))},handleSelectionChange(e){this.selItems=e},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},handleEdit(e){this.$router.push({path:"/PostBlog",query:{from:e.bid}})},handleDelete(e){var t=this;this.$confirm("是否删除该类别下选中的菜品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0;$("/blog/dustbinOne",{bid:e.bid}).then((e=>{if(200==e.status){var a=e.data;t.$message({type:a.status,message:a.msg}),"success"==a.status&&window.$bus.$emit("TableReload")}else t.$message({type:"error",message:"删除失败!"});t.loading=!1,t.dustbinData=[]}),(e=>{t.loading=!1,t.$message({type:"error",message:"删除失败!"}),t.dustbinData=[]}))})).catch((()=>{t.$message({type:"info",message:"已取消删除"}),t.dustbinData=[]}))}},props:["state"]},ba=va,ya=(0,o.Z)(ba,ga,fa,!1,null,null,null),wa=ya.exports,xa={mounted:function(){},beforeRouteLeave(e,t,a){"博客详情"==e.name?this.needRefresh=!1:this.needRefresh=!0,a()},activated(){this.needRefresh&&this.load()},data(){return{needRefresh:!0,isAdmin:!1}},methods:{load(){this.$refs.reload.reload(),this.$refs.my.reload()}},components:{blog_table:pa,MyBlogTableVue:wa}},_a=xa,ka=(0,o.Z)(_a,la,oa,!1,null,null,null),Sa=ka.exports,$a=function(){var e=this,t=e._self._c;return t("div",[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticStyle:{"text-align":"left"}},[t("el-button",{staticStyle:{"padding-bottom":"0px"},attrs:{type:"text",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回")])],1)]),t("el-col",{attrs:{span:24}},[t("div",[t("div",[t("h3",{staticStyle:{"margin-top":"0px","margin-bottom":"0px","text-align":"center"}},[e._v(" "+e._s(e.blog.blogTitle)+" ")])]),t("div",{staticStyle:{width:"100%","margin-top":"5px",display:"flex","justify-content":"flex-end","align-items":"center"}},[t("span",[e._v("作者:"+e._s(e.username))]),e._v("  "),t("span",{staticStyle:{margin:"0px 50px 0px 0px"}},[e._v("电话:"+e._s(e.phone))]),t("p",[e._v("邮箱:"+e._s(e.email))])]),t("div",{staticStyle:{width:"100%","margin-top":"5px",display:"flex","justify-content":"flex-end","align-items":"center"}},[t("span",[t("i",{on:{click:function(t){return e.loveVote()}}},[e._v("点赞博客: "+e._s(e.blog.like?"♥":"♡"))]),e._v(" "+e._s(e.blog.liked))]),e._v("   "),t("p",{staticStyle:{"font-size":"small",color:"grey"}},[e._v("按时间顺序前十点赞用户:")]),e._l(e.userDTO,(function(a,s){return t("div",{key:s,staticStyle:{display:"inline",color:"#20a0ff","margin-right":"5px","font-size":"12px"}},[t("div",[t("img",{attrs:{src:a.avatar,width:"30",height:"30"},on:{click:function(t){return e.toMsg(a)}}}),t("br"),t("span",{on:{click:function(t){return e.toMsg(a)}}},[e._v(e._s(a.username))])])])}))],2)])])],1),t("el-col",[t("mavon_editor",{staticClass:"markdown-body",attrs:{codeStyle:e.blog.code},domProps:{innerHTML:e._s(e.blog.blogContent)}})],1)],1)},Ca=[],Da={components:{mavon_editor:ta.mavonEditor},mounted(){this.blog=this.$route.query.blog;var e=this.$route.query.bid;this.username=this.$route.query.username,this.email=this.$route.query.email,this.phone=this.$route.query.phone,this.avatar=this.$route.query.avatar,C("/blog/getABlog/"+e).then((e=>{this.blog=e.data})),this.loadUserFans(e)},methods:{toMsg(e){this.$router.push({path:"/Example",query:{username:e.username,phone:e.phone,avatar:e.avatar,email:e.email,uid:e.uid}})},loadUserFans(e){C("/blog/blogLikes/"+e).then((e=>{this.userDTO=e.data}))},loveVote(){_("/blog/likeBlog",{bid:this.blog.bid}).then((e=>{this.blog.like=!this.blog.like,this.blog.like?this.blog.liked=this.blog.liked+1:this.blog.liked=this.blog.liked-1,this.loadUserFans(this.blog.bid)}))},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},goBack(){this.$router.go(-1)}},data(){return{userDTO:{},bid:0,username:"",avatar:"",phone:"",email:"",blog:{like:!1}}}},Ta=Da,Ma=(0,o.Z)(Ta,$a,Ca,!1,null,"261feb09",null),ja=Ma.exports,za=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"添加工作内容",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateText()}}},[e._v("确 定")])],1)],1),t("el-calendar",{scopedSlots:e._u([{key:"dateCell",fn:function({data:a}){return[e._v(" "+e._s(a.day.split("-").slice(1).join("-"))+" "),t("i",{staticClass:"el-icon-s-release",on:{click:function(t){return e.oneForm(a)}}}),e._l(e.calendarData,(function(s,i){return t("span",{key:i},[a.day==s?t("span",[e._v(" ✔️ ")]):e._e()])})),t("br"),t("br"),e._l(e.calendarText,(function(s,i){return t("div",{key:i+1e3},[a.day==s.createTime?t("div",[t("i",{staticClass:"el-icon-s-comment",staticStyle:{color:"blue"},on:{click:function(t){return e.open(a)}}}),e._v("   "),t("el-popconfirm",{attrs:{title:"这是一段内容确定删除吗? "},on:{confirm:function(t){return e.deleteText(a)}}},[t("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1):e._e()])}))]}}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submit()}}},[e._v("签到")]),e._v("     "),t("span",[e._v("本月已连续签到")]),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.count)+" ")]),t("span",[e._v("天")])],1)},Fa=[],Na={mounted(){this.value=this.formatDate(new Date),this.loadCalendar(),this.loadKeepSign()},data(){return{isShow:!1,count:0,flag:!1,curDate:"",textarea:"",value:new Date,dialogFormVisible:!1,calendarData:[],calendarText:[]}},methods:{deleteText(e){$("/deleteText",{createTime:e.day}).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.loadCalendar()}))},loadKeepSign(){C("/sign/count").then((e=>{this.count=e.data}))},oneForm(e){this.dialogFormVisible=!0,this.textarea="",this.flag=!1;for(var t=0;t<this.calendarText.length;t++)if(this.calendarText[t].createTime==e.day){this.textarea=this.calendarText[t].text,this.flag=!0;break}this.curDate=e.day,console.log(this.curDate)},updateText(){if(0==this.textarea.length)return this.$message({type:"error",message:"输入不得为空"}),!1;var e="";this.flag?(e="/updateText",S(e,{text:this.textarea,createTime:this.curDate}).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.loadCalendar()}))):(e="/text",_(e,{text:this.textarea,createTime:this.curDate}).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.loadCalendar()}))),this.dialogFormVisible=!1},open(e){for(var t="",a=0;a<this.calendarText.length;a++)if(this.calendarText[a].createTime==e.day){t=this.calendarText[a].text;break}this.$notify({title:e.day,offset:100,message:this.$createElement("div",{style:" word-wrap: break-word;word-break:break-all;color:teal"},t),duration:0})},formatDate(e){return je()(e).format("YYYY-MM-DD")},submit(){_("/sign").then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.value=this.formatDate(new Date),this.loadCalendar(),this.loadKeepSign()}))},loadCalendar(){C("/getSign").then((e=>{this.calendarData=e.data.key,this.calendarText=e.data.value}))}}},Aa=Na,Ia=(0,o.Z)(Aa,za,Fa,!1,null,null,null),Oa=Ia.exports,Va=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.myuid==e.uid?"我的主页":"TA的主页")+" ")]),t("el-col",{attrs:{span:24}},[t("div",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"success",icon:"el-icon-back"},on:{click:function(t){return e.goBack()}}},[e._v("返回")])],1),t("br")]),t("br"),t("el-header",{staticClass:"cate_mana_header"},[t("img",{staticStyle:{width:"50px",height:"50px","margin-left":"20px"},attrs:{src:e.userMsg.avatar}}),t("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.userMsg.username))]),t("span",{staticStyle:{"margin-left":"15px"}},[e._v("电话:"+e._s(e.userMsg.phone))]),t("span",{staticStyle:{"margin-left":"15px"}},[e._v("邮箱:"+e._s(e.userMsg.email))]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.addNewFriend()}}},[e._v(e._s(e.isFollow?"已关注":"关注"))])],1),t("el-container",{staticClass:"menu_list"},[t("el-main",{staticClass:"main"},[t("el-tabs",{attrs:{type:"border-card"}},[e.myuid==e.uid?t("el-tab-pane",{attrs:{label:"我的关注"}},[t("follow_table",{key:(new Date).getTime(),attrs:{uid:e.uid,state:"0"}})],1):e._e(),e.myuid!=e.uid?t("el-tab-pane",{attrs:{label:"TA的关注"}},[t("follow_table",{key:(new Date).getTime(),attrs:{uid:e.uid,state:"0"}})],1):e._e(),e.myuid!=e.uid?t("el-tab-pane",{attrs:{label:"共同关注"}},[e.myuid!=e.uid?t("follow_table",{key:(new Date).getTime(),attrs:{uid:e.userMsg.uid,state:"1"}}):e._e()],1):e._e(),e.myuid==e.uid?t("el-tab-pane",{attrs:{label:"博客朋友圈"}},[t("moment_table",{key:(new Date).getTime()})],1):e._e()],1)],1)],1)],1)},Pa=[],Ba=function(){var e=this,t=e._self._c;return t("div",e._l(e.msg,(function(a,s){return t("div",{key:s,staticClass:"infinite-list-item",staticStyle:{width:"100%",height:"70px","margin-top":"20px","padding-left":"5px"}},[t("span",[t("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:a.avatar},on:{click:function(t){return e.toMsg(a)}}})]),t("span",{staticStyle:{"margin-left":"5px"},on:{click:function(t){return e.toMsg(a)}}},[e._v(e._s(a.username))]),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("电话:"+e._s(a.phone))]),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("邮箱:"+e._s(a.email))])])})),0)},Ea=[],Ya={mounted(){var e=this;if(0==e.uid)return!1;0==this.state?C("/follow/"+this.uid).then((t=>{e.msg=t.data})):C("/common/"+this.uid).then((t=>{e.msg=t.data}))},data(){return{msg:{}}},methods:{toMsg(e){this.$router.push({path:"/Example",query:{username:e.username,phone:e.phone,avatar:e.avatar,email:e.email,uid:e.uid}})}},props:["uid","state"]},Ra=Ya,Za=(0,o.Z)(Ra,Ba,Ea,!1,null,"ec7a2c2a",null),Ua=Za.exports,qa=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"text-align":"left"}},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",icon:"el-icon-refresh-left"},on:{click:function(t){return e.refresh()}}},[e._v("刷新")])],1),t("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticClass:"infinite-list",staticStyle:{overflow:"auto"},attrs:{"infinite-scroll-immediate":"true","infinite-scroll-distance":"1"}},e._l(e.arr,(function(a,s){return t("div",{key:s,staticClass:"infinite-list-item",staticStyle:{height:"250px","margin-top":"5px"}},[t("div",{staticStyle:{"text-align":"center"}},[t("span",{staticStyle:{color:"blue"}},[e._v(e._s(a.blogTitle))])]),t("br"),t("div",[t("span",[e._v(e._s(a.mdContent.substring(0,450)))]),t("span",{staticStyle:{color:"blueviolet","text-decoration":"underline"},on:{click:function(t){return e.itemClick(a)}}},[e._v("点击查看详情")])]),t("br"),t("div",[t("el-row",{staticStyle:{"text-align":"right"}},[t("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:a.user.avatar},on:{click:function(t){return e.toMsg(a.user)}}}),t("span",{staticStyle:{"margin-left":"5px",color:"brown"},on:{click:function(t){return e.toMsg(a.user)}}},[e._v(e._s(a.user.username))]),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("电话:"+e._s(a.user.phone))]),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("邮箱:"+e._s(a.user.email))])])],1),t("el-divider")],1)})),0)])},La=[],Ha={mounted(){this.lastId=(new Date).getTime(),this.offset=0,this.load()},data(){return{arr:[],msg:[],count:0,offset:0,lastId:0}},methods:{toMsg(e){this.$router.push({path:"/Example",query:{username:e.username,phone:e.phone,avatar:e.avatar,email:e.email,uid:e.uid}})},itemClick(e){this.$router.push({path:"/BlogDetail",query:{blog:e,bid:e.bid,username:e.user.username,phone:e.user.phone,email:e.user.email,avatar:e.user.avatar}})},refresh(){this.offset=0,this.lastId=(new Date).getTime(),this.load(),this.$message({type:"success",message:"已刷新"})},load(){var e=[];0!=this.offset&&(e=this.arr);var t=this;if(void 0==this.lastId&&void 0==this.offset)return!1;var a="/blog/of/follow?offset="+this.offset+"&lastId="+this.lastId;C(a).then((a=>{t.msg=a.data.list,t.lastId=a.data.minTime,t.offset=a.data.offset;for(var s=0;s<t.msg.length;s++)e.push(t.msg[s]);this.arr=e}))}},props:["uid"]},Ka=Ha,Ga=(0,o.Z)(Ka,qa,La,!1,null,"2df05ff2",null),Ja=Ga.exports,Wa={mounted:function(){this.userMsg.username=this.$route.query.username,this.userMsg.uid=this.$route.query.uid,this.userMsg.email=this.$route.query.email,this.userMsg.avatar=this.$route.query.avatar,this.userMsg.phone=this.$route.query.phone,this.uid=this.userMsg.uid,C("/or/not/"+this.userMsg.uid).then((e=>{this.isFollow=e.data})),C("/currentUserId").then((e=>{this.myuid=e.data}))},watch:{$route(){this.$router.go(0)}},methods:{goBack(){this.$router.go(-1)},addNewFriend(){S("/"+this.userMsg.uid+"/"+this.isFollow).then((e=>{this.isFollow=!this.isFollow,this.$message({type:e.data.status,message:e.data.msg})}))}},data(){return{flag:-1,myuid:0,uid:0,isFollow:!1,isAdmin:!1,userMsg:{uid:0,username:"",email:"",phone:"",avatar:""}}},components:{follow_table:Ua,moment_table:Ja}},Xa=Wa,Qa=(0,o.Z)(Xa,Va,Pa,!1,null,"34bb57aa",null),es=Qa.exports,ts=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"text-align":"left","margin-left":"20px"}},[t("el-button",{attrs:{type:"success"},on:{click:e.goBack}},[e._v("返回")])],1),t("br"),t("br"),t("div",{staticStyle:{"margin-left":"20px"}},[t("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"输入具体地址添加门店"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getMsg()}}},[e._v("搜索")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getAll()}}},[e._v("获取所有门店")])],1),t("br"),t("br"),t("span",{staticStyle:{"margin-left":"20px"}},[e._v("请选择地图缩放大小:")]),t("el-select",{attrs:{placeholder:"请选择地图缩放大小"},on:{change:e.setlevel},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},e._l(15,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1),t("el-dialog",{attrs:{title:"添加门店",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-select",{attrs:{placeholder:"请选择最近的地理位置"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.msg,(function(a,s){return t("el-option",{key:s,attrs:{value:a.district+a.name}},[e._v(e._s(a.district+a.name))])})),1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOne()}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"所有门店",visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},e._l(e.shops,(function(a,s){return t("div",{key:s+1},[e._v(" "+e._s(s+1+". "+a.name+"门店")+"  "),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除 ")]),t("el-divider")],1)})),0),e._m(0)],1)},as=[function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"container"}})])}],ss=a(1618),is=a.n(ss),rs={name:"gaode",data(){return{level:10,shops:[],map:null,autoComplete:null,keywords:"",msg:[],state1:"",dialogFormVisible:!1,dialogFormVisible2:!1,value:"",a:120.073221,b:30.312392}},mounted(){var e=this;this.initMap(e.a,e.b,e.level)},methods:{setlevel(){var e=this;this.initMap(e.a,e.b,e.level)},handleDelete(e){var t=this;console.log(e.longitude+","+e.latitude),$("/geo/deleteOne/"+e.gid).then((e=>{this.$message({type:e.data.status,message:e.data.msg}),this.initMap(t.a,t.b,t.level),this.dialogFormVisible2=!1}))},goBack(){this.$router.go(-1)},getMsg(){this.dialogFormVisible=!0,C("/map/getSearch/"+this.keywords).then((e=>{this.msg=e.data.tips}))},getAll(){this.dialogFormVisible2=!0},addOne(){null==this.value&&this.$message({type:"error",message:"请选择附近门店"}),console.log(this.value);for(var e=0;e<this.msg.length;e++)if(this.value==this.msg[e].district+this.msg[e].name)break;var t=this.msg[e].location,a=this;if("undefined"==t||null==t)return this.$message({type:"error",message:"请输入更详细一些的地址"}),!1;console.log(t);var s=t.indexOf(","),i=t.substring(0,s),r=t.substring(s+1);_("/geo/addOne",{longitude:i,latitude:r,name:this.msg[e].district+this.msg[e].name}).then((e=>{this.$message({type:e.data.status,message:e.data.msg})})),this.addPoint(i,r),this.initMap(i,r,a.level),this.dialogFormVisible=!1,this.value=""},addPoint(e,t){var a=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[e,t]});this.map.add(a)},initMap(e,t,a){is().load({key:"6192f4511a76dd1436cfd9644a26f3e1",version:"2.0",plugins:["AMap.Geolocation"],terrain:!0}).then((s=>{this.map=new s.Map("container",{viewMode:"3D",zoom:a,center:[e,t],terrain:!0});var i="/geo/aroundShop?state=2";C(i).then((e=>{this.shops=e.data.list;for(var t=0;t<this.shops.length;t++)this.addPoint(this.shops[t].longitude,this.shops[t].latitude)}))})).catch((e=>{console.log(e)}))}}},ns=rs,ls=(0,o.Z)(ns,ts,as,!1,null,"41c02903",null),os=ls.exports,cs=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[t("el-container",[t("el-main",{staticStyle:{width:"100px"}},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"部门管理",name:"depmana"}},[1==e.states[0]?t("DepartmentManaVue"):e._e()],1),t("el-tab-pane",{attrs:{label:"员工管理",name:"empmana"}},[1==e.states[1]?t("EmployeeManaVue"):e._e()],1),t("el-tab-pane",{attrs:{label:"职位管理",name:"posmana"}},[1==e.states[2]?t("PositionManaVue"):e._e()],1),t("el-tab-pane",{attrs:{label:"等级管理",name:"levelmana"}},[1==e.states[3]?t("LevelManaVue"):e._e()],1),t("el-tab-pane",{attrs:{label:"账套管理",name:"salarymana"}},[1==e.states[4]?t("SalaryManaVue"):e._e()],1),t("el-tab-pane",{attrs:{label:"用户管理",name:"usermana"}},[1==e.states[5]?t("UserManaVue"):e._e()],1)],1)],1)],1)],1)},ds=[],us=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"700px"}},[t("el-input",{attrs:{placeholder:"请输入部门名称进行搜索...","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("br"),t("br"),t("el-tree",{ref:"tree",attrs:{data:e.deps,props:e.defaultProps,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function({node:a,data:s}){return t("span",{staticClass:"custom-tree-node",staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[t("span",[e._v(e._s(a.label))]),t("span",[t("el-button",{staticClass:"depBtn",attrs:{type:"primary",size:"mini"},on:{click:()=>e.showAddDepView(s)}},[e._v(" 添加部门 ")]),t("el-button",{staticClass:"depBtn",attrs:{type:"danger",size:"mini"},on:{click:()=>e.deleteDep(s)}},[e._v(" 删除部门 ")])],1)])}}])}),t("el-dialog",{attrs:{title:"添加部门",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",[t("table",[t("tr",[t("td",[t("el-tag",[e._v("上级部门")])],1),t("td",[e._v(e._s(e.pname))])]),t("tr",[t("td",[t("el-tag",[e._v("部门名称")])],1),t("td",[t("el-input",{attrs:{placeholder:"请输入部门名称..."},model:{value:e.dep.name,callback:function(t){e.$set(e.dep,"name",t)},expression:"dep.name"}})],1)])])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.doAddDep}},[e._v("确定")])],1)])],1)},ms=[],hs={name:"depmana",data(){return{filterText:"",deps:[],defaultProps:{children:"children",label:"name"},dep:{name:"",parentId:-1},pname:"",dialogVisible:!1}},watch:{filterText(e){this.$refs.tree.filter(e)}},mounted(){this.initDeps()},methods:{initDep(){this.dep={name:"",parentId:-1},this.pname=""},initDeps(){C("/admin/department/all").then((e=>{this.deps=e.data}))},removeDepFromDeps(e,t,a){for(let s=0;s<t.length;s++){let i=t[s];if(i.id==a)return t.splice(s,1),void(0==t.length&&(e.isParent=!1));this.removeDepFromDeps(i,i.children,a)}},addDep2Deps(e,t){for(let a=0;a<e.length;a++){let s=e[a];if(console.log(s.name),s.id==t.parentId)return s.children.push(t),void(s.isParent=!0);this.addDep2Deps(s.children,t)}},doAddDep(){_("/admin/department/add",{name:this.dep.name,parentId:this.dep.parentId}).then((e=>{this.dialogVisible=!1,this.addDep2Deps(this.deps,e.data.obj),this.initDep()}))},showAddDepView(e){this.pname=e.name,this.dep.parentId=e.id,this.dialogVisible=!0},deleteDep(e){1!=e.id?e.isParent?this.$message.error("父部门删除失败！"):this.$confirm("此操作将永久删除该【"+e.name+"】部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{$("/admin/department/"+e.id).then((t=>{"success"==t.data.status&&(this.$message({type:t.data.status,message:t.data.msg}),this.removeDepFromDeps(null,this.deps,e.id))}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})})):this.$message.error("公司无法被失败！")},filterNode(e,t){return!e||-1!==t.name.indexOf(e)}}},ps=hs,gs=(0,o.Z)(ps,us,ms,!1,null,"2dcf2270",null),fs=gs.exports,vs=function(){var e=this,t=e._self._c;return t("el-container",[t("el-dialog",{attrs:{title:"修改公司员工信息",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 姓名:"),t("span",{staticStyle:{"font-weight":"normal"}},[e._v(" "+e._s(e.username))]),e._v("  性别:"),t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.staffOne.gender,callback:function(t){e.$set(e.staffOne,"gender",t)},expression:"staffOne.gender"}},e._l(["男","女"],(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1),e._v("   年龄:"),t("el-input",{staticStyle:{width:"100px"},model:{value:e.staffOne.age,callback:function(t){e.$set(e.staffOne,"age",t)},expression:"staffOne.age"}}),e._v("   学历:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.staffOne.education,callback:function(t){e.$set(e.staffOne,"education",t)},expression:"staffOne.education"}},e._l(["大专","本科","研究生","高中","博士","初中","小学"],(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1)],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 毕业院校:"),t("el-input",{staticStyle:{width:"200px"},model:{value:e.staffOne.college,callback:function(t){e.$set(e.staffOne,"college",t)},expression:"staffOne.college"}}),e._v("   专业:"),t("el-input",{staticStyle:{width:"200px"},model:{value:e.staffOne.major,callback:function(t){e.$set(e.staffOne,"major",t)},expression:"staffOne.major"}})],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 联系地址:"),t("el-input",{staticStyle:{width:"500px"},model:{value:e.staffOne.address,callback:function(t){e.$set(e.staffOne,"address",t)},expression:"staffOne.address"}})],1),t("br"),t("br"),t("br"),t("h3",{staticStyle:{float:"left"}},[e._v(" 个人职位:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.curcate,callback:function(t){e.curcate=t},expression:"curcate"}},e._l(e.positions,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1)],1),t("h3",{staticStyle:{float:"left"}},[e._v("   个人等级:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.curcate2,callback:function(t){e.curcate2=t},expression:"curcate2"}},e._l(e.categories,(function(e,a){return t("el-option",{key:a,attrs:{value:e.levelName}})})),1)],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 所属部门:"),t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.staffOne.department,callback:function(t){e.$set(e.staffOne,"department",t)},expression:"staffOne.department"}},e._l(e.deps,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1),e._v("  账套选择:"),t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.cursalary,callback:function(t){e.cursalary=t},expression:"cursalary"}},e._l(e.salaries,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1)],1),t("br"),t("br"),t("br"),t("h3",{staticStyle:{float:"left"}},[e._v("个人简历")]),t("br"),t("br"),t("el-input",{attrs:{type:"textarea"},model:{value:e.staffOne.description,callback:function(t){e.$set(e.staffOne,"description",t)},expression:"staffOne.description"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateStaff()}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"个人简历",visible:e.dialogVisible2},on:{"update:visible":function(t){e.dialogVisible2=t}}},[e._v(" "+e._s(e.personMsg)+" ")]),t("el-main",{staticClass:"cate_mana_main"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"20px"}},[t("div",[t("el-input",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入员工名进行搜索...",clearable:""},on:{clear:e.searchClick},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick.apply(null,arguments)}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("搜索 ")])],1),t("div",[t("el-upload",{staticStyle:{display:"inline-flex","margin-right":"8px"},attrs:{action:"/admin/staff/import","before-upload":e.beforeUpload,"on-success":e.onSuccess,"on-error":e.onError,disabled:e.importDataDisabled,"show-file-list":!1}},[t("el-button",{attrs:{disabled:e.importDataDisabled,type:"success",icon:e.importDataBtnIcon}},[e._v(" "+e._s(e.importDataBtnText)+" ")])],1),t("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:e.exportData}},[e._v(" 导出数据 ")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.staff,"tooltip-effect":"dark",border:!0,stripe:!0},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"编号",prop:"id",type:"index",index:e.hIndex,width:"50",align:"center",fixed:"left"}}),t("el-table-column",{attrs:{prop:"username",label:"姓名",width:"120",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.username))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.username.length>5?a.row.username.substr(0,5)+"...":a.row.username.substr(0,5)))])])]}}])}),t("el-table-column",{attrs:{label:"电话",prop:"phone",width:"120",align:"center"}}),t("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.email))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.email.length>20?a.row.email.substr(0,20)+"...":a.row.email.substr(0,20)))])])]}}])}),t("el-table-column",{attrs:{label:"性别",prop:"gender",width:"80",align:"center"}}),t("el-table-column",{attrs:{label:"年龄",prop:"age",width:"80",align:"center"}}),t("el-table-column",{attrs:{label:"学历",prop:"education",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"address",label:"联系地址",width:"320"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.address))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.address.length>20?a.row.address.substr(0,20)+"...":a.row.address.substr(0,20)))])])]}}])}),t("el-table-column",{attrs:{prop:"college",label:"毕业院校",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.college))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.college.length>10?a.row.college.substr(0,10)+"...":a.row.college.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{prop:"major",label:"专业",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.major))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.major.length>10?a.row.major.substr(0,10)+"...":a.row.major.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{label:"职位",prop:"name",width:"200",align:"center"}}),t("el-table-column",{attrs:{label:"等级",prop:"levelName",width:"200",align:"center"}}),t("el-table-column",{attrs:{prop:"department",label:"所属部门",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.row.department))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.row.department.length>10?a.row.department.substr(0,10)+"...":a.row.department.substr(0,10)))])])]}}])}),t("el-table-column",{attrs:{prop:"description",label:"个人简历",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.toMsg(a.row.description)}}},[e._v("查看")])]}}])}),t("el-table-column",{attrs:{prop:"salary",label:"工资账套",align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",[e._v(e._s(a.row.salary))])]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:"上次修改时间",align:"center",width:"200px",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"left",fixed:"right",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])})],1),t("br"),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.staff.length>0,expression:"staff.length > 0"}],attrs:{background:"","page-size":e.pageSize,layout:"sizes, prev, pager, next, jumper, ->, total, slot",total:e.totalCount},on:{"current-change":e.currentChange,"size-change":e.sizeChange}}),this.staff.length>0?t("el-button",{staticStyle:{"margin-top":"10px",width:"100px",float:"left"},attrs:{type:"danger",disabled:0==this.selItems.length},on:{click:e.deleteAll}},[e._v("批量删除 ")]):e._e()],1)],1)},bs=[];const ys=v().create({responseType:"arraybuffer"});ys.interceptors.request.use((e=>{if(!e.url.endsWith("/login")&&null!=localStorage.getItem("token")){const t="Bearer "+localStorage.getItem("token");e.headers.common["Authorization"]=t}return e})),ys.interceptors.response.use((e=>{const t=e.headers;let s=RegExp(/application\/json/);if(t["content-type"].match(s))e.data=_s(e.data);else{let s=a(5823),i=t["content-disposition"].split(";")[1].split("filename=")[1],r=t["content-type"];i=decodeURIComponent(i),s(e.data,i,r)}}),(e=>{console.log(e)}));let ws="";const xs=(e,t)=>ys({method:"get",url:`${ws}${e}`,data:t});function _s(e){let t=String.fromCharCode.apply(null,new Uint8Array(e)),a=decodeURIComponent(escape(t));return JSON.parse(a)}var ks={name:"empmana",mounted(){this.loading=!0,this.refresh(1,this.pageSize),C("/admin/level/all").then((e=>{this.categories=e.data})),C("/admin/position/all").then((e=>{this.positions=e.data})),C("/admin/department/allChild").then((e=>{this.deps=e.data})),C("/admin/salary/all").then((e=>{this.salaries=e.data}))},methods:{onError(){this.importDataBtnText="导入数据",this.importDataBtnIcon="el-icon-upload2",this.importDataDisabled=!1},onSuccess(e){"error"==e.status?this.$message({type:"error",message:e.msg+",请检查文件格式,文件大小且导入列名不得为空！     "}):this.$message({type:"success",message:"导入成功"}),this.importDataBtnText="导入数据",this.importDataBtnIcon="el-icon-upload2",this.importDataDisabled=!1,this.refresh(this.currentPage,this.pageSize)},beforeUpload(){this.importDataBtnText="正在导入",this.importDataBtnIcon="el-icon-loading",this.importDataDisabled=!0},exportData(){xs("/admin/staff/export")},updateStaff(){if(console.log(this.curcate,this.curcate2,this.staffOne.description,this.staffOne.college,this.staffOne.education,this.staffOne.major,this.staffOne.gender),aa(this.curcate,this.curcate2,this.staffOne.description,this.staffOne.college,this.staffOne.education,this.staffOne.major,this.staffOne.gender,this.staffOne.department,this.cursalary)){for(var e=0;e<this.positions.length;e++)if(this.positions[e].name==this.curcate)break;var t=this.positions[e].id;for(e=0;e<this.categories.length;e++)if(this.categories[e].levelName==this.curcate2)break;var a=this.categories[e].id;S("/admin/staff/updateThisStaff",{id:this.staffOne.id,uid:this.staffOne.uid,pid:t,lid:a,description:this.staffOne.description,college:this.staffOne.college,major:this.staffOne.major,gender:this.staffOne.gender,age:this.staffOne.age,education:this.staffOne.education,department:this.staffOne.department,salary:this.cursalary}).then((e=>{"success"==e.data.status&&(this.$message({type:"success",message:e.data.msg}),this.dialogVisible=!1,this.refresh(this.currentPage,this.pageSize))}))}else this.$message({type:"error",message:"数据不能为空!"})},toMsg(e){this.dialogVisible2=!0,this.personMsg=e},currentChange(e){this.currentPage=e,this.loading=!0,this.refresh(e,this.pageSize)},sizeChange(e){this.pageSize=e,this.loading=!0,this.refresh(this.currentPage,this.pageSize)},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},deleteAll(){var e=this;this.$confirm("确认删除这 "+this.selItems.length+" 条数据?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{for(var t=e.selItems,a="",s="",i=0;i<t.length;i++)a+=t[i].id+",",s+=t[i].uid+",";e.deleteCate(a.substring(0,a.length-1),s.substring(0,s.length-1))})).catch((()=>{e.loading=!1}))},handleSelectionChange(e){this.selItems=e},handleEdit(e){this.cursalary=e.salary,this.username=e.username,this.curcate=e.name,this.curcate2=e.levelName,Object.assign(this.staffOne,e),this.dialogVisible=!0},handleDelete(e,t){let a=this;this.$confirm("确认删除 "+t.username+" 这个员工吗 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.deleteCate(t.id,t.uid)})).catch((()=>{a.loading=!1}))},deleteCate(e,t){var a=this;this.loading=!0,$("/admin/staff/delete/"+e+"/"+t).then((e=>{var t=e.data;a.$message({type:t.status,message:t.msg}),a.refresh(a.currentPage,a.pageSize)}))},refresh(e,t){this.loading=!0;var a=this,s="/admin/staff/all?username="+this.keywords+"&page="+e+"&count="+t;C(s).then((e=>{a.loading=!1,200==e.status&&(a.staff=e.data.staff,a.totalCount=e.data.totalCount)}),(e=>{a.loading=!1,403==e.response.status&&a.$message({type:"error",message:e.response.data})})).catch((e=>{a.loading=!1}))},searchClick(){this.loading=!0,this.currentPage=1,this.refresh(1,this.pageSize)}},computed:{hIndex(){return(this.currentPage-1)*this.pageSize+1}},data(){return{importDataBtnText:"导入数据",importDataBtnIcon:"el-icon-upload2",importDataDisabled:!1,deps:"",username:"",positions:[],curcate:"",curcate2:"",categories:[],staffOne:{description:"",gender:"",college:"",education:"",age:"",major:"",address:"",department:""},updatePersonMsg:"",personMsg:"",dialogVisible:!1,dialogVisible2:!1,isAdmin:!1,selItems:[],loading:!1,currentPage:1,totalCount:-1,pageSize:10,keywords:"",staff:[],salaries:[],cursalary:""}}},Ss=ks,$s=(0,o.Z)(Ss,vs,bs,!1,null,"33ac2c90",null),Cs=$s.exports,Ds=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.showAddSalaryView}},[e._v("添加工资账套 ")])],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-table",{attrs:{data:e.salaries,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index",label:"编号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"账套名称",width:"120"}}),t("el-table-column",{attrs:{prop:"basicSalary",label:"基本工资",width:"70"}}),t("el-table-column",{attrs:{prop:"trafficSalary",label:"交通补助",width:"70"}}),t("el-table-column",{attrs:{prop:"lunchSalary",label:"午餐补助",width:"70"}}),t("el-table-column",{attrs:{prop:"bonus",label:"奖金",width:"70"}}),t("el-table-column",{attrs:{prop:"createDate",label:"启用时间",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:"养老金"}},[t("el-table-column",{attrs:{prop:"pensionPer",label:"比率",width:"70"}}),t("el-table-column",{attrs:{prop:"pensionBase",label:"基数",width:"70"}})],1),t("el-table-column",{attrs:{align:"center",label:"医疗保险"}},[t("el-table-column",{attrs:{prop:"medicalPer",label:"比率",width:"70"}}),t("el-table-column",{attrs:{prop:"medicalBase",label:"基数",width:"70"}})],1),t("el-table-column",{attrs:{align:"center",label:"公积金"}},[t("el-table-column",{attrs:{prop:"accumulationFundPer",label:"比率",width:"70"}}),t("el-table-column",{attrs:{prop:"accumulationFundBase",label:"基数",width:"70"}})],1),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showEditSalaryView(a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteSalary(a.row)}}},[e._v("删除 ")])]}}])})],1)],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticStyle:{display:"flex","justify-content":"space-around","align-items":"center"}},[t("el-steps",{attrs:{active:e.activeItemIndex,direction:"vertical"}},e._l(e.salaryItemName,(function(e,a){return t("el-step",{key:a,attrs:{title:e}})})),1),e._l(e.salary,(function(a,s,i){return t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.activeItemIndex==i,expression:"activeItemIndex == index"}],key:i,staticStyle:{width:"200px"},attrs:{placeholder:"请输入"+e.salaryItemName[i]+"..."},model:{value:e.salary[s],callback:function(t){e.$set(e.salary,s,t)},expression:"salary[title]"}})}))],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.preStep}},[e._v(e._s(10==e.activeItemIndex?"取消":"上一步"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v(" "+e._s(10==e.activeItemIndex?"完成":"下一步"))])],1)])],1)},Ts=[],Ms={name:"salarymana",data(){return{salaries:[],dialogVisible:!1,activeItemIndex:0,dialogTitle:"添加工资账套",salaryItemName:["账套名称","基本工资","交通补助","午餐补助","奖金","养老金比率","养老金基数","医疗保险比率","医疗保险基数","公积金比率","公积金基数"],salary:{name:"",basicSalary:0,trafficSalary:0,lunchSalary:0,bonus:0,pensionPer:0,pensionBase:0,medicalPer:0,medicalBase:0,accumulationFundPer:0,accumulationFundBase:0}}},mounted(){this.initSalaries()},methods:{showEditSalaryView(e){this.dialogTitle="编辑工资账套",this.dialogVisible=!0,this.activeItemIndex=0,Object.assign(this.salary,e)},deleteSalary(e){this.$confirm("此操作将永久删除该【"+e.name+"】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{$("/admin/salary/delete/"+e.id).then((e=>{"success"==e.data.status&&(this.$message({type:"success",message:e.data.msg}),this.initSalaries())}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},preStep(){0!=this.activeItemIndex&&(10!=this.activeItemIndex?this.activeItemIndex--:this.dialogVisible=!1)},nextStep(){10!=this.activeItemIndex?this.activeItemIndex++:this.salary.id?S("/admin/salary/update",{id:this.salary.id,name:this.salary.name,basicSalary:this.salary.basicSalary,trafficSalary:this.salary.trafficSalary,lunchSalary:this.salary.lunchSalary,bonus:this.salary.bonus,pensionPer:this.salary.pensionPer,pensionBase:this.salary.pensionBase,medicalPer:this.salary.medicalPer,medicalBase:this.salary.medicalBase,accumulationFundPer:this.salary.accumulationFundPer,accumulationFundBase:this.salary.accumulationFundBase}).then((e=>{e&&(this.$message({type:"success",message:e.data.msg}),this.initSalaries(),this.dialogVisible=!1)})):x("/admin/salary/add",this.salary).then((e=>{e&&(this.$message({type:"success",message:e.data.msg}),this.initSalaries(),this.dialogVisible=!1)}))},showAddSalaryView(){this.salary={name:"",basicSalary:0,trafficSalary:0,lunchSalary:0,bonus:0,pensionPer:0,pensionBase:0,medicalPer:0,medicalBase:0,accumulationFundPer:0,accumulationFundBase:0},this.activeItemIndex=0,this.dialogTitle="添加工资账套",this.dialogVisible=!0},initSalaries(){C("/admin/salary/all").then((e=>{this.salaries=e.data}))}}},js=Ms,zs=(0,o.Z)(js,Ds,Ts,!1,null,"4ee53ecc",null),Fs=zs.exports,Ns=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-dialog",{attrs:{title:"添加为公司员工",visible:e.dialogVisible2},on:{"update:visible":function(t){e.dialogVisible2=t}}},[t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 姓名:"),t("span",{staticStyle:{"font-weight":"normal"}},[e._v(" "+e._s(e.username))]),e._v("  性别:"),t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.staff.gender,callback:function(t){e.$set(e.staff,"gender",t)},expression:"staff.gender"}},e._l(["男","女"],(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1),e._v("   年龄:"),t("el-input",{staticStyle:{width:"100px"},model:{value:e.staff.age,callback:function(t){e.$set(e.staff,"age",t)},expression:"staff.age"}}),e._v("   学历:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.staff.education,callback:function(t){e.$set(e.staff,"education",t)},expression:"staff.education"}},e._l(["大专","本科","研究生","高中","博士","初中","小学"],(function(e,a){return t("el-option",{key:a,attrs:{value:e}})})),1)],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 毕业院校:"),t("el-input",{staticStyle:{width:"200px"},model:{value:e.staff.college,callback:function(t){e.$set(e.staff,"college",t)},expression:"staff.college"}}),e._v("   专业:"),t("el-input",{staticStyle:{width:"200px"},model:{value:e.staff.major,callback:function(t){e.$set(e.staff,"major",t)},expression:"staff.major"}})],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 联系地址:"),t("el-input",{staticStyle:{width:"500px"},model:{value:e.staff.address,callback:function(t){e.$set(e.staff,"address",t)},expression:"staff.address"}})],1),t("br"),t("br"),t("br"),t("h3",{staticStyle:{float:"left"}},[e._v(" 个人职位:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.curcate,callback:function(t){e.curcate=t},expression:"curcate"}},e._l(e.positions,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1)],1),t("h3",{staticStyle:{float:"left"}},[e._v("   个人等级:"),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.curcate2,callback:function(t){e.curcate2=t},expression:"curcate2"}},e._l(e.categories,(function(e,a){return t("el-option",{key:a,attrs:{value:e.levelName}})})),1)],1),t("br"),t("br"),t("br"),t("div",{staticStyle:{float:"left","font-size":"15px","font-weight":"bolder"}},[e._v(" 所属部门:"),t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.staff.department,callback:function(t){e.$set(e.staff,"department",t)},expression:"staff.department"}},e._l(e.deps,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1),e._v("  账套选择:"),t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.cursalary,callback:function(t){e.cursalary=t},expression:"cursalary"}},e._l(e.salaries,(function(e,a){return t("el-option",{key:a,attrs:{value:e.name}})})),1)],1),t("br"),t("br"),t("br"),t("h3",{staticStyle:{float:"left"}},[e._v("个人简历")]),t("br"),t("br"),t("el-input",{attrs:{type:"textarea"},model:{value:e.staff.description,callback:function(t){e.$set(e.staff,"description",t)},expression:"staff.description"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible2=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOneStaff()}}},[e._v("确 定")])],1)],1),t("div",{staticStyle:{"margin-top":"10px","margin-bottom":"25px",display:"flex","justify-content":"center"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"默认展示部分用户，可以通过用户名搜索用户...","prefix-icon":"el-icon-search",size:"small"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),t("el-button",{staticStyle:{"margin-left":"3px"},attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.searchClick}},[e._v("搜索 ")])],1),t("div",{staticStyle:{display:"flex","justify-content":"space-around","flex-wrap":"wrap"}},e._l(e.users,(function(a,s){return t("el-card",{key:s,staticStyle:{width:"330px","margin-top":"10px"}},[t("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(a.username))]),t("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"#ff0509"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.deleteUser(a.uid)}}},[e._v("删除 ")])],1),t("div",[t("div",[t("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:a.avatar},on:{error:e.setDefaultImage}})]),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[t("span",[e._v("用户名:")]),t("span",[e._v(e._s(a.username))])]),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[t("span",[e._v("电话:")]),t("span",[e._v(e._s(a.phone))])]),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[t("span",[e._v("电子邮箱:")]),t("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",width:"68",trigger:"click"}},[t("span",[e._v(e._s(a.email))]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(a.email.length>20?a.email.substr(0,20)+"...":a.email.substr(0,20)))])])],1),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[t("span",[e._v("注册时间:")]),t("span",[e._v(e._s(e.formatDate(a.regTime))+" ")])]),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px",display:"flex","align-items":"center"}},[t("span",[e._v("用户状态:")]),t("el-switch",{staticStyle:{"font-size":"12px"},attrs:{"active-text":"启用","active-color":"#13ce66","inactive-text":"禁用"},on:{change:function(t){return e.enabledChange(a.enabled,a.uid,s)}},model:{value:a.enabled,callback:function(t){e.$set(a,"enabled",t)},expression:"user.enabled"}})],1),t("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px",display:"flex","align-items":"center"}},[t("span",[e._v("是否为公司员工:")]),e._v("  "),t("el-tag",{directives:[{name:"show",rawName:"v-show",value:!a.staff,expression:"!user.staff"}],attrs:{size:"mini"}},[e._v("否")]),t("el-tag",{directives:[{name:"show",rawName:"v-show",value:a.staff,expression:"user.staff"}],attrs:{size:"mini",type:"danger"}},[e._v("是")]),e._v("   "),t("span",{directives:[{name:"show",rawName:"v-show",value:0==a.staff,expression:"user.staff == false"}],staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"22px","align-items":"center"}},[t("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.open(a,s)}}})])],1)])])})),1)],1)},As=[],Is=a.p+"img/R-C.26d0226d.jpg",Os={name:"usermana",mounted:function(){this.loading=!0,this.loadUserList(),C("/admin/level/all").then((e=>{this.categories=e.data})),C("/admin/position/all").then((e=>{this.positions=e.data})),C("/admin/department/allChild").then((e=>{this.deps=e.data})),C("/admin/salary/all").then((e=>{this.salaries=e.data}))},methods:{setDefaultImage(e){e.target.src=Is},initStaff(){this.staff={description:"",gender:"",college:"",education:"",age:"",major:"",address:"",department:""}},addOneStaff(){if(this.staff.age<0||this.staff.age>100)this.$message({type:"error",message:"年龄必须合法!"});else if(aa(this.curcate,this.curcate2,this.staff.description,this.staff.college,this.staff.education,this.staff.major,this.staff.gender,this.staff.department,this.cursalary)){for(var e=0;e<this.positions.length;e++)if(this.positions[e].name==this.curcate)break;var t=this.positions[e].id;for(e=0;e<this.categories.length;e++)if(this.categories[e].levelName==this.curcate2)break;var a=this.categories[e].id;x("/admin/staff/addOne",{pid:t,lid:a,uid:this.uid,description:this.staff.description,college:this.staff.college,major:this.staff.major,gender:this.staff.gender,age:this.staff.age,education:this.staff.education,address:this.staff.address,department:this.staff.department,salary:this.cursalary}).then((e=>{"success"==e.data.status&&(this.$message({type:"success",message:e.data.msg}),this.loadOneUserById(this.uid,this.index),this.initStaff(),this.cursalary="",this.curcate="",this.curcate2="",this.dialogVisible2=!1)}))}else this.$message({type:"error",message:"数据不能为空!"})},open(e,t){this.index=t,this.uid=e.uid,this.username=e.username,this.dialogVisible2=!0},formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},deleteUser(e){var t=this;this.$confirm("删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.loading=!0,$("/admin/user/"+e).then((e=>{if(200==e.status&&"success"==e.data.status)return t.$message({type:"success",message:e.data.msg}),void t.loadUserList();t.loading=!1,t.$message({type:"error",message:e.data.msg})}),(e=>{t.loading=!1,t.$message({type:"error",message:"删除失败!"})}))})).catch((()=>{t.$message({type:"info",message:"已取消删除"})}))},enabledChange(e,t,a){var s=this;S("/admin/user/enabled",{enabled:e,uid:t}).then((e=>{200==e.status?s.$message({type:"success",message:"更新成功!"}):s.$message({type:"error",message:"更新失败!"})}),(e=>{s.$message({type:"error",message:"更新失败!"})}))},loadOneUserById(e,t){var a=this;C("/admin/user/"+e).then((e=>{200==e.status?a.users.splice(t,1,e.data):a.$message({type:"error",message:"数据加载失败!"})}))},loadUserList(){var e=this;C("/admin/user/all?username="+this.keywords).then((t=>{e.loading=!1,200==t.status?e.users=t.data:e.$message({type:"error",message:"数据加载失败!"})}),(t=>{if(e.loading=!1,403==t.response.status){var a=t.response.data;e.$message({type:"error",message:a})}}))},searchClick(){this.loading=!0,this.loadUserList()}},data(){return{deps:[],username:"",staff:{description:"",gender:"",college:"",education:"",age:"",major:"",address:"",department:""},index:"",id:"",uid:"",categories:[],positions:[],curcate:"",curcate2:"",dialogVisible2:!1,loading:!1,keywords:"",users:[],salaries:[],cursalary:""}}},Vs=Os,Ps=(0,o.Z)(Vs,Ns,As,!1,null,null,null),Bs=Ps.exports,Es=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",{staticClass:"cate_mana_header"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入职位名称"},model:{value:e.cateName,callback:function(t){e.cateName=t},expression:"cateName"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"medium"},on:{click:e.addNewCate}},[e._v("新增职位")])],1),t("el-main",{staticClass:"cate_mana_main"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.categories,"tooltip-effect":"dark",border:!0,stripe:!0},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"编号",prop:"id",type:"index",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"职位名称",prop:"name",width:"300",align:"center"}}),t("el-table-column",{attrs:{prop:"createTime",label:"启用时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])})],1),this.categories.length>0?t("el-button",{staticStyle:{"margin-top":"10px",width:"100px",float:"left"},attrs:{type:"danger",disabled:0==this.selItems.length},on:{click:e.deleteAll}},[e._v("批量删除 ")]):e._e()],1)],1)},Ys=[],Rs={name:"posmana",mounted(){this.loading=!0,this.refresh();var e=this;C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data)}))},methods:{formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},addNewCate(){this.loading=!0;var e=this;return this.categories.length>=this.maxLimitCategory?(this.$message({type:"error",message:"等级种类已达上限"}),e.loading=!1,!1):0==this.cateName.length||-1!="        ".indexOf(this.cateName)?(this.$message({type:"error",message:"等级种类名不得为空"}),e.loading=!1,!1):this.cateName.length>=11?(this.$message({type:"error",message:"等级种类名长度不得超过10个"}),e.loading=!1,!1):void _("/admin/position/add",{name:this.cateName}).then((t=>{if(200==t.status){var a=t.data;e.$message({type:a.status,message:a.msg}),e.cateName="",e.refresh()}e.loading=!1}))},deleteAll(){var e=this;this.$confirm("确认删除这 "+this.selItems.length+" 条数据?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{for(var t=e.selItems,a="",s=0;s<t.length;s++)a+=t[s].id+",";e.deleteCate(a.substring(0,a.length-1))})).catch((()=>{e.loading=!1}))},handleSelectionChange(e){this.selItems=e},handleEdit(e,t){this.$prompt("请输入新名称","编辑",{confirmButtonText:"更新",inputValue:t.name,cancelButtonText:"取消"}).then((({value:e})=>{this.loading=!0;var a=this;return 0==e.length||-1!="               ".indexOf(e)?(this.$message({type:"error",message:"职位种类名不得为空"}),void(a.loading=!1)):e.length>=11?(this.$message({type:"error",message:"职位种类名长度不得超过10个"}),void(a.loading=!1)):(a.loading=!0,void S("/admin/position/update",{id:t.id,name:e}).then((e=>{var t=e.data;a.$message({type:t.status,message:t.msg}),a.refresh()})))}))},handleDelete(e,t){let a=this;this.$confirm("确认删除 "+t.name+" ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.deleteCate(t.id)})).catch((()=>{a.loading=!1}))},deleteCate(e){var t=this;this.loading=!0,$("/admin/position/delete/"+e).then((e=>{var a=e.data;t.$message({type:a.status,message:a.msg}),t.refresh()}),(e=>{t.loading=!1,403==e.response.status?t.$message({type:"error",message:"权限不足,请联系管理员"}):500==e.response.status&&t.$message({type:"error",message:"该栏目下尚有文章，删除失败!"})}))},refresh(){let e=this;C("/admin/position/all").then((t=>{e.categories=t.data,e.loading=!1}))}},data(){return{isAdmin:!1,maxLimitCategory:10,cateName:"",selItems:[],categories:[],loading:!1}}},Zs=Rs,Us=(0,o.Z)(Zs,Es,Ys,!1,null,"26818478",null),qs=Us.exports,Ls=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",{staticClass:"cate_mana_header"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入等级名称"},model:{value:e.cateName,callback:function(t){e.cateName=t},expression:"cateName"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"medium"},on:{click:e.addNewCate}},[e._v("新增等级")])],1),t("el-main",{staticClass:"cate_mana_main"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.categories,"tooltip-effect":"dark",border:!0,stripe:!0},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"编号",prop:"id",type:"index",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"等级名称",prop:"levelName",width:"300",align:"center"}}),t("el-table-column",{attrs:{prop:"createTime",label:"启用时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])})],1),this.categories.length>0?t("el-button",{staticStyle:{"margin-top":"10px",width:"100px",float:"left"},attrs:{type:"danger",disabled:0==this.selItems.length},on:{click:e.deleteAll}},[e._v("批量删除 ")]):e._e()],1)],1)},Hs=[],Ks={name:"levelmana",mounted(){this.loading=!0,this.refresh();var e=this;C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data)}))},methods:{formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm:ss")},addNewCate(){this.loading=!0;var e=this;return this.categories.length>=this.maxLimitCategory?(this.$message({type:"error",message:"等级种类已达上限"}),e.loading=!1,!1):0==this.cateName.length||-1!="        ".indexOf(this.cateName)?(this.$message({type:"error",message:"等级种类名不得为空"}),e.loading=!1,!1):this.cateName.length>=11?(this.$message({type:"error",message:"等级种类名长度不得超过10个"}),e.loading=!1,!1):void _("/admin/level/add",{name:this.cateName}).then((t=>{if(200==t.status){var a=t.data;e.$message({type:a.status,message:a.msg}),e.cateName="",e.refresh()}e.loading=!1}))},deleteAll(){var e=this;this.$confirm("确认删除这 "+this.selItems.length+" 条数据?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{for(var t=e.selItems,a="",s=0;s<t.length;s++)a+=t[s].id+",";e.deleteCate(a.substring(0,a.length-1))})).catch((()=>{e.loading=!1}))},handleSelectionChange(e){this.selItems=e},handleEdit(e,t){this.$prompt("请输入新名称","编辑",{confirmButtonText:"更新",inputValue:t.levelName,cancelButtonText:"取消"}).then((({value:e})=>{this.loading=!0;var a=this;return 0==e.length||-1!="               ".indexOf(e)?(this.$message({type:"error",message:"等级种类名不得为空"}),void(a.loading=!1)):e.length>=11?(this.$message({type:"error",message:"等级种类名长度不得超过10个"}),void(a.loading=!1)):(a.loading=!0,a.isAdmin?void S("/admin/level/update",{id:t.id,name:e}).then((e=>{var t=e.data;a.$message({type:t.status,message:t.msg}),a.refresh()}),(e=>{403==e.response.status&&a.$message({type:"error",message:"权限不足,请联系管理员"}),a.loading=!1})):(this.$message({type:"error",message:"权限不足,请联系管理员!!!"}),void(a.loading=!1)))}))},handleDelete(e,t){let a=this;this.$confirm("确认删除 "+t.levelName+" ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a.deleteCate(t.id)})).catch((()=>{a.loading=!1}))},deleteCate(e){var t=this;this.loading=!0,$("/admin/level/delete/"+e).then((e=>{var a=e.data;t.$message({type:a.status,message:a.msg}),t.refresh()}),(e=>{t.loading=!1,403==e.response.status?t.$message({type:"error",message:"权限不足,请联系管理员"}):500==e.response.status&&t.$message({type:"error",message:"该栏目下尚有文章，删除失败!"})}))},refresh(){let e=this;C("/admin/level/all").then((t=>{e.categories=t.data,e.loading=!1}))}},data(){return{isAdmin:!1,maxLimitCategory:10,cateName:"",selItems:[],categories:[],loading:!1}}},Gs=Ks,Js=(0,o.Z)(Gs,Ls,Hs,!1,null,"ee6bc6a2",null),Ws=Js.exports,Xs={mounted(){var e=this;this.loading=!0,C("/isAdmin").then((t=>{200==t.status&&(e.isAdmin=t.data,0==e.isAdmin&&e.$message({type:"error",message:"权限不足,请联系管理员"}))}))},data(){return{states:[1,0,0,0,0,0],titles:["depmana","empmana","posmana","levelmana","salarymana","usermana"],labels:["部门管理","员工管理","职位管理","等级管理","账套管理","用户管理"],activeName:"depmana",isAdmin:!1}},methods:{handleClick(e){for(var t=0;t<this.labels.length;t++)if(e.label==this.labels[t]){for(var a=0;a<this.states.length;a++)this.states[a]=0;this.states[t]=1;break}}},components:{LevelManaVue:Ws,PositionManaVue:qs,DepartmentManaVue:fs,EmployeeManaVue:Cs,SalaryManaVue:Fs,UserManaVue:Bs}},Qs=Xs,ei=(0,o.Z)(Qs,cs,ds,!1,null,null,null),ti=ei.exports,ai=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"friendChat"}},[t("div",{staticClass:"sidebar"},[t("card"),t("list")],1),t("div",{staticClass:"main"},[t("message"),t("usertext")],1)])},si=[],ii=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"card"}},[t("header",[t("img",{staticClass:"avatar",attrs:{src:e.user.avatar,alt:e.user.username}}),t("p",{staticClass:"name"},[e._v(e._s(e.user.username))])]),t("footer",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$store.state.filterKey,expression:"$store.state.filterKey"}],staticClass:"search",attrs:{type:"text",placeholder:"默认搜索前5的匹配用户"},domProps:{value:e.$store.state.filterKey},on:{keyup:e.search,input:function(t){t.target.composing||e.$set(e.$store.state,"filterKey",t.target.value)}}})])])},ri=[],ni={name:"card",methods:{search(e){13===e.keyCode&&this.$store.dispatch("initData")}},data(){return{user:JSON.parse(window.sessionStorage.getItem("user"))}}},li=ni,oi=(0,o.Z)(li,ii,ri,!1,null,"02447c32",null),ci=oi.exports,di=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"list"}},[t("ul",{staticStyle:{"padding-left":"0px","scroll-margin-top":"50px"}},e._l(e.admins,(function(a){return t("li",{class:{active:!!e.currentSession&&a.username===e.currentSession.username},on:{click:function(t){return e.changeCurrentSession(a)}}},[t("img",{staticClass:"avatar",attrs:{src:a.avatar,alt:a.username},on:{error:e.setDefaultImage}}),t("p",{staticClass:"name"},[e._v(e._s(a.username))])])})),0)])},ui=[],mi=a(629),hi={name:"list",data(){return{}},computed:(0,mi.rn)(["admins","currentSession"]),methods:{setDefaultImage(e){e.target.src=Is},changeCurrentSession:function(e){this.$store.commit("changeCurrentSessionId",e)}}},pi=hi,gi=(0,o.Z)(pi,di,ui,!1,null,"3129bfde",null),fi=gi.exports,vi=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"scroll-bottom",rawName:"v-scroll-bottom",value:e.sessions,expression:"sessions"}],attrs:{id:"message"}},[e.currentSession?t("ul",e._l(e.sessions[e.user.username+"#"+e.currentSession.username],(function(a){return t("li",[t("p",{staticClass:"time"},[t("span",[e._v(e._s(e.formatDate(a.date)))])]),t("div",{staticClass:"main",class:{self:a.self}},[t("img",{staticClass:"avatar",attrs:{src:a.self?e.user.avatar:e.currentSession.avatar,alt:""}}),t("p",{directives:[{name:"show",rawName:"v-show",value:a.self,expression:"entry.self"}],staticClass:"text"},[e._v(e._s(a.content))]),t("p",{directives:[{name:"show",rawName:"v-show",value:!a.self,expression:"!entry.self"}],staticClass:"text",staticStyle:{float:"left"}},[e._v(" "+e._s(a.content)+" ")])])])})),0):e._e()])},bi=[],yi={name:"message",methods:{formatDate(e){return je()(e).format("YYYY-MM-DD HH:mm")}},data(){return{user:JSON.parse(window.sessionStorage.getItem("user"))}},computed:(0,mi.rn)(["sessions","currentSession"]),directives:{"scroll-bottom"(e){setTimeout((function(){e.scrollTop+=9999}),1)}}},wi=yi,xi=(0,o.Z)(wi,vi,bi,!1,null,"ee1fcf78",null),_i=xi.exports,ki=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"uesrtext"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],attrs:{placeholder:"按 Ctrl + Enter 发送"},domProps:{value:e.content},on:{keyup:e.addMessage,input:function(t){t.target.composing||(e.content=t.target.value)}}})])},Si=[],$i={name:"uesrtext",data(){return{content:""}},computed:(0,mi.rn)(["sessions","currentSession"]),methods:{addMessage(e){if(e.ctrlKey&&13===e.keyCode&&this.content.length){let e=new Object;e.to=this.currentSession.username,e.content=this.content,e.notSelf=!1,this.$store.state.stomp.send("/ws/chat",{},JSON.stringify(e)),this.$store.commit("addMessage",e),this.content=""}}}},Ci=$i,Di=(0,o.Z)(Ci,ki,Si,!1,null,"2878c926",null),Ti=Di.exports,Mi={name:"FriendChat",data(){return{}},mounted:function(){this.$store.dispatch("initData")},components:{card:ci,list:fi,message:_i,usertext:Ti}},ji=Mi,zi=(0,o.Z)(ji,ai,si,!1,null,null,null),Fi=zi.exports;s["default"].use(u.ZP);var Ni=new u.ZP({routes:[{path:"/ms",name:"登录",hidden:!0,component:Xe},{path:"/",name:"登录",hidden:!0,component:Z},{path:"/re",component:Le,name:"注册",hidden:!0},{path:"/home",name:"首页",component:ae,hidden:!0},{path:"/home",component:ae,name:"点菜服务",children:[{path:"/MenuList",name:"点菜大厅",keepAlive:!0,component:Ce,meta:{keepAlive:!0}},{path:"/MenuDetail",name:"菜品详情",component:Ee,hidden:!0,meta:{keepAlive:!1}},{path:"/Voucher",name:"优惠券抢购",component:Xt,meta:{keepAlive:!1}}]},{path:"/Home",component:ae,children:[{path:"/MyCurOrder",name:"我的订单(进行中)",component:Tt}]},{path:"/Home",component:ae,children:[{path:"/MyOrder",name:"已支付订单",component:Ae}]},{path:"/home",component:ae,children:[{path:"/jiedan",name:"骑手接单",component:dt}]},{path:"/Home",component:ae,children:[{path:"/MenuMangeList",name:"菜品管理",meta:{keepAlive:!0},component:_t}]},{path:"/Home",component:ae,children:[{path:"/OrdersManage",name:"订单管理",component:At}]},{path:"/Home",component:ae,children:[{path:"/MoneyManage",name:"财务管理",component:Et}]},{path:"/Home",component:ae,children:[{path:"/CateMana",name:"分类管理",component:Lt}]},{path:"/Home",component:ae,name:"博客系统",children:[{path:"/BlogList",name:"博客大厅",meta:{keepAlive:!0},component:Sa},{path:"/BlogDetail",name:"博客详情",hidden:!0,meta:{keepAlive:!1},component:ja},{path:"/PostBlog",name:"发表博客",component:na,meta:{keepAlive:!1}}]},{path:"/Home",component:ae,children:[{path:"/DateSign",name:"签到日历",meta:{keepAlive:!0},component:Oa}]},{path:"/Example",name:"Example",meta:{keepAlive:!0},hidden:!0,component:es},{path:"/Map",component:os,children:[{path:"/Map",name:"门店管理",component:os}]},{path:"/Home",component:ae,children:[{path:"/EmpList",name:"公司管理",component:ti}]},{path:"/Home",component:ae,children:[{path:"/FriendChat",name:"公司管理",component:Fi}]}]}),Ai=a(7822),Ii=a(4774),Oi=a.n(Ii),Vi=a(8e3),Pi=a.n(Vi);s["default"].use(mi.ZP);new Date;const Bi=new mi.ZP.Store({state:{routes:[],sessions:{},currentAdmin:JSON.parse(window.sessionStorage.getItem("user")),admins:[],currentSession:null,filterKey:"",stomp:null},mutations:{INIT_CURRENTAdmin(e,t){e.currentAdmin=t},initRoutes(e,t){e.routes=t},changeCurrentSessionId(e,t){e.currentSession=t},addMessage(e,t){let a=e.sessions[e.currentAdmin.username+"#"+t.to];a||s["default"].set(e.sessions,e.currentAdmin.username+"#"+t.to,[]),e.sessions[e.currentAdmin.username+"#"+t.to].push({content:t.content,date:new Date,self:!t.notSelf})},INIT_DATA(e){let t=window.localStorage.getItem("vue-chat-session");t&&(e.sessions=JSON.parse(t))},INIT_ADMIN(e,t){e.admins=t}},actions:{connect(e){e.state.stomp=Oi().over(new(Pi())("/ws/ep"));let t=window.localStorage.getItem("token"),a="Bearer "+t;e.state.stomp.connect({"Auth-Token":a},(t=>{e.state.stomp.subscribe("/user/queue/chat",(t=>{let a=JSON.parse(t.body);a.notSelf=!0,console.log(a.to+":"+a.from),a.to=a.from,console.log(a.to+":"+a.from),e.commit("addMessage",a)}))}),(e=>{}))},initData(e){e.commit("INIT_DATA");let t="/chat/all?username=";t+=this.state.filterKey,C(t).then((t=>{t&&e.commit("INIT_ADMIN",t.data)}))}}});Bi.watch((function(e){return e.sessions}),(function(e){window.localStorage.setItem("vue-chat-session",JSON.stringify(e))}),{deep:!0});var Ei=Bi;s["default"].prototype.$echarts=Ai,s["default"].use(y()),s["default"].config.productionTip=!1,window.$bus=new s["default"],new s["default"]({router:Ni,store:Ei,render:e=>e(d)}).$mount("#app")}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){var e=[];a.O=function(t,s,i,r){if(!s){var n=1/0;for(d=0;d<e.length;d++){s=e[d][0],i=e[d][1],r=e[d][2];for(var l=!0,o=0;o<s.length;o++)(!1&r||n>=r)&&Object.keys(a.O).every((function(e){return a.O[e](s[o])}))?s.splice(o--,1):(l=!1,r<n&&(n=r));if(l){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,i,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,r,n=s[0],l=s[1],o=s[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(i in l)a.o(l,i)&&(a.m[i]=l[i]);if(o)var d=o(a)}for(t&&t(s);c<n.length;c++)r=n[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},s=self["webpackChunkmodel"]=self["webpackChunkmodel"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(1269)}));s=a.O(s)})();
//# sourceMappingURL=app.d40d6b21.js.map